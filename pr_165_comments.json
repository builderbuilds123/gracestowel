{"comments":[{"id":"IC_kwDOQZPgfs7gv01Q","author":{"login":"railway-app"},"authorAssociation":"NONE","body":"<!-- railway-bot-comment-version=2 -->\n\n<!-- railway-project-id=\"1db1a2ab-ac35-4ff8-8bb7-355bb0896f26\" railway-project-name=\"Grace's Towel Platform\" -->\nüöÖ Deployed to the [gracestowel-pr-165](https://railway.com/project/1db1a2ab-ac35-4ff8-8bb7-355bb0896f26?environmentId=aa575f54-eec3-42aa-bb6f-69e645178acf) environment in **[Grace's Towel Platform](https://railway.com/project/1db1a2ab-ac35-4ff8-8bb7-355bb0896f26)**\n| **Service** | **Status** | **Web** | **Updated** (UTC) |\n| :--- | :--- | :--- | :--- |\n|  medusa-api | ‚úÖ Success ([View Logs](https://railway.com/project/1db1a2ab-ac35-4ff8-8bb7-355bb0896f26/service/1511857a-a741-47dc-9d64-f523184f63ce?id=fb77604f-e659-4048-ac01-9efe94554beb&environmentId=aa575f54-eec3-42aa-bb6f-69e645178acf)) | [Web](https://graces-towel-staging-gracestowel-pr-165.up.railway.app) | Jan 20, 2026 at 1:31 am |","createdAt":"2026-01-20T01:27:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770633552","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv01T","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"<!-- This is an auto-generated comment: summarize by coderabbit.ai -->\n<!-- other_code_reviewer_warning_start -->\n\n> [!NOTE]\n> ## Other AI code review bot(s) detected\n> \n> CodeRabbit has detected other AI code review bot(s) in this pull request and will avoid duplicating their findings in the review comments. This may lead to a less comprehensive review.\n\n<!-- other_code_reviewer_warning_end -->\n\n<!-- walkthrough_start -->\n\n<details>\n<summary>üìù Walkthrough</summary>\n\n## Walkthrough\n\nAdds admin feed notifications and local provider; implements password-reset emails and subscriber; normalizes email payloads; enforces CSRF across storefront API endpoints; adds CheckoutProvider/useCheckout with shipping-rates orchestration and Medusa cart integration; many UI refactors, hooks, tests, env validation, and removal of two CI AI workflows.\n\n## Changes\n\n| Cohort / File(s) | Summary |\n|---|---|\n| **CI workflows (removed)** <br> `‚Äã.github/workflows/claude.yml`, `‚Äã.github/workflows/gemini-docs-update.yml` | Deleted two GitHub Actions workflows that invoked AI tooling. |\n| **Backend ‚Äî notifications & email templates** <br> `apps/backend/medusa-config.ts`, `apps/backend/src/lib/admin-notifications.ts`, `apps/backend/src/modules/resend/emails/password-reset.tsx`, `apps/backend/src/modules/resend/service.ts` | Register local \"feed\" notification provider, add AdminNotificationType + sendAdminNotification helper, add password-reset email template and register it in Templates. |\n| **Backend ‚Äî queue & workers** <br> `apps/backend/src/lib/email-queue.ts`, `apps/backend/src/workers/email-worker.ts`, `apps/backend/src/workers/payment-capture-worker.ts` | Normalize payloads (orderId ‚Üí entityId; use Templates enum), update job naming/logging, tighten DLQ behavior, and notify admins on permanent failures. |\n| **Backend ‚Äî subscribers** <br> `apps/backend/src/subscribers/*` <br> `customer-created.ts`, `customer-password-reset.ts`, `fulfillment-created.ts`, `inventory-backordered.ts`, `order-canceled.ts`, `order-placed.ts` | Add customer-password-reset subscriber; enqueue password-reset emails; add non-blocking admin notifications after existing event flows. |\n| **Backend ‚Äî env validation & startup loader** <br> `apps/backend/src/lib/env.ts`, `apps/backend/src/loaders/env-validation.ts` | Add Zod backend env schema, typed BackendEnv, validate/get helpers, and a startup loader that validates env at boot. |\n| **Storefront ‚Äî checkout core & UI components** <br> `apps/storefront/app/components/...` <br> `checkout/CheckoutProvider.tsx`, `checkout/CheckoutContent.tsx`, `CheckoutForm.tsx`, `OrderSummary.tsx`, `checkout/ShippingSection.tsx`, `checkout/PaymentSection.tsx` | Replace prop-driven checkout with CheckoutProvider + useCheckout; add CheckoutContent and modular ShippingSection/PaymentSection; migrate CheckoutForm and OrderSummary to hook-driven state/actions. |\n| **Storefront ‚Äî hooks & state machines** <br> `apps/storefront/app/hooks/*` <br> `useCheckoutState.ts`, `useCheckoutError.tsx`, `useShippingRates.ts`, `useShippingPersistence.ts`, `usePromoCode.ts`, `usePaymentCollection.ts` | Add reducer-based checkout state, comprehensive error hook, shipping-rates orchestration with caching/retries, reducer-driven promo & shipping persistence, and constants-driven debounce. |\n| **Storefront ‚Äî Medusa cart integration & context** <br> `apps/storefront/app/context/*`, `apps/storefront/app/services/medusa-cart.ts`, `apps/storefront/app/context/MedusaCartContext.tsx` | Add MedusaCartProvider & useMedusaCart, persist cartId, expose medusaCart/isLoading, and add transferCart API for guest‚Üíuser cart migration. |\n| **Storefront ‚Äî CSRF server utilities & client injection** <br> `apps/storefront/app/utils/csrf.server.ts`, `apps/storefront/app/utils/monitored-fetch.ts` | Add server helpers to create/validate CSRF cookie/token and have monitoredFetch inject X-CSRF-Token for same-origin requests. |\n| **Storefront ‚Äî API routes: CSRF, validations & new endpoints** <br> `apps/storefront/app/routes/api*` (many files) | Add CSRF validation to POST/PATCH endpoints, input validation, expose expanded cart totals, add cart transfer endpoint, and update tests to mock CSRF. |\n| **Storefront ‚Äî auth pages & CustomerContext** <br> `apps/storefront/app/routes/account.*.tsx`, `apps/storefront/app/context/CustomerContext.tsx` | Add forgot-password and reset-password pages; CustomerContext gains requestPasswordReset and updatePassword; login/register accept optional cartId for transfer. |\n| **Storefront ‚Äî constants, types & sanitize util** <br> `apps/storefront/app/constants/checkout.ts`, `apps/storefront/app/utils/sanitize.ts`, `apps/storefront/app/types/*` | Add CHECKOUT_CONSTANTS, sanitize and sanitizeAddress utilities (DOMPurify), checkout types, and extend CartWithPromotions with totals fields. |\n| **Storefront ‚Äî root, tests, deps & typings** <br> `apps/storefront/app/root.tsx`, `apps/storefront/tests/*`, `apps/storefront/package.json`, `tests/test-utils.tsx`, `worker-configuration.d.ts` | Create CSRF token in loader and return headers, wrap app/tests with MedusaCartProvider, add dompurify/zod deps, update env typings and tests to mock CSRF. |\n| **E2E, tests & docs** <br> `apps/e2e/tests/*`, `apps/backend/integration-tests/*`, `docs/sprint/*` | Add full guest-checkout E2E and many unit/test updates (CSRF mocks, medusa cart state, renamed payloads); add sprint docs for customer/password-reset/address-management and notification stories. |\n\n## Sequence Diagram(s)\n\n```mermaid\nsequenceDiagram\n    participant User as User\n    participant Frontend as CheckoutContent\n    participant Provider as CheckoutProvider\n    participant Shipping as useShippingRates\n    participant Backend as Medusa Backend\n\n    rect rgba(200,200,255,0.5)\n    User->>Frontend: open checkout\n    Frontend->>Provider: read checkout state\n    Provider->>Shipping: fetchShippingRates(items,address,total)\n    Shipping->>Backend: POST /api/carts (create/sync)\n    Backend-->>Shipping: cart_id\n    Shipping->>Backend: GET /api/carts/{id}/shipping-options\n    Backend-->>Shipping: options\n    Shipping-->>Provider: setShippingOptions\n    end\n\n    rect rgba(200,255,200,0.5)\n    User->>Frontend: select shipping / enter payment\n    Frontend->>Provider: selectShippingOption / startPayment\n    Provider->>Backend: persist selection / create payment session\n    Backend-->>Provider: persisted / session\n    Frontend->>Frontend: render payment element / confirm\n    end\n```\n\n```mermaid\nsequenceDiagram\n    participant UI as Forgot/Reset Page\n    participant Context as CustomerContext\n    participant API as Backend API\n    participant Email as Resend\n\n    rect rgba(255,230,200,0.5)\n    UI->>Context: requestPasswordReset(email)\n    Context->>API: POST /auth/request-password-reset\n    API->>Email: enqueue reset email (passwordResetEmail)\n    Email-->>API: queued\n    API-->>Context: success\n    Context-->>UI: show confirmation\n    end\n\n    rect rgba(255,200,230,0.5)\n    UI->>Context: updatePassword(password, token)\n    Context->>API: POST /auth/reset-password\n    API-->>Context: success\n    Context-->>UI: success + redirect\n    end\n```\n\n```mermaid\nsequenceDiagram\n    participant Event as Medusa Event\n    participant Subscriber as Backend Subscriber\n    participant Notif as sendAdminNotification\n    participant Service as Notification Module\n    participant Provider as Local Notification Provider\n\n    rect rgba(230,230,255,0.5)\n    Event->>Subscriber: order.placed / fulfillment.created / inventory.backordered / etc.\n    Subscriber->>Notif: sendAdminNotification(container,data)\n    Notif->>Service: resolve notification service\n    Service-->>Notif: notification module\n    Notif->>Provider: send(channel: \"feed\", template: \"admin-ui\")\n    Provider-->>Notif: ack\n    Notif-->>Subscriber: logged result\n    end\n```\n\n## Estimated code review effort\n\nüéØ 4 (Complex) | ‚è±Ô∏è ~60 minutes\n\n## Possibly related PRs\n\n- builderbuilds123/gracestowel#162 ‚Äî Overlaps storefront fetch utilities and Medusa cart / checkout changes.  \n- builderbuilds123/gracestowel#159 ‚Äî Related to loader/env handling and cart sync adjustments.  \n- builderbuilds123/gracestowel#158 ‚Äî Overlaps checkout/UI refactors and hooks.\n\n## Suggested reviewers\n\n- leonthecreatar\n\n## Poem\n\n> üêá  \n> I hopped through keys and cookies late at night,  \n> Hid CSRF tokens snug and set them right,  \n> Fed admins news and queued a reset mail,  \n> Wove guest carts to users along the trail,  \n> Tiny rabbit patch ‚Äî code tidy and bright!\n\n</details>\n\n<!-- walkthrough_end -->\n\n\n<!-- pre_merge_checks_walkthrough_start -->\n\n<details>\n<summary>üö• Pre-merge checks | ‚úÖ 2 | ‚ùå 1</summary>\n\n<details>\n<summary>‚ùå Failed checks (1 warning)</summary>\n\n|     Check name     | Status     | Explanation                                                                           | Resolution                                                                         |\n| :----------------: | :--------- | :------------------------------------------------------------------------------------ | :--------------------------------------------------------------------------------- |\n| Docstring Coverage | ‚ö†Ô∏è Warning | Docstring coverage is 43.84% which is insufficient. The required threshold is 80.00%. | Write docstrings for the functions missing them to satisfy the coverage threshold. |\n\n</details>\n<details>\n<summary>‚úÖ Passed checks (2 passed)</summary>\n\n|     Check name    | Status   | Explanation                                                                                                                                                                                               |\n| :---------------: | :------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Description Check | ‚úÖ Passed | Check skipped - CodeRabbit‚Äôs high-level summary is enabled.                                                                                                                                               |\n|    Title check    | ‚úÖ Passed | The PR title 'feat(checkout): refactor checkout flow and add E2E tests' directly reflects the main changes: refactoring the checkout route and adding E2E tests, matching the raw summary and objectives. |\n\n</details>\n\n<sub>‚úèÔ∏è Tip: You can configure your own custom pre-merge checks in the settings.</sub>\n\n</details>\n\n<!-- pre_merge_checks_walkthrough_end -->\n\n<!-- finishing_touch_checkbox_start -->\n\n<details>\n<summary>‚ú® Finishing touches</summary>\n\n- [ ] <!-- {\"checkboxId\": \"7962f53c-55bc-4827-bfbf-6a18da830691\"} --> üìù Generate docstrings\n\n</details>\n\n<!-- finishing_touch_checkbox_end -->\n\n<!-- tips_start -->\n\n---\n\n\n\n<sub>Comment `@coderabbitai help` to get the list of available commands and usage tips.</sub>\n\n<!-- tips_end -->\n\n<!-- internal state start -->\n\n\n<!-- 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 -->\n\n<!-- internal state end -->","createdAt":"2026-01-20T01:27:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770633555","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv1GD","author":{"login":"cloudflare-workers-and-pages"},"authorAssociation":"NONE","body":"## Deploying with &nbsp;<a href=\"https://workers.dev\"><img alt=\"Cloudflare Workers\" src=\"https://workers.cloudflare.com/logo.svg\" width=\"16\"></a> &nbsp;Cloudflare Workers\nThe latest updates on your project. Learn more about [integrating Git with Workers](https://developers.cloudflare.com/workers/ci-cd/builds/git-integration/).\n\n| Status | Name | Latest Commit | Preview URL | Updated (UTC) |\n| -|-|-|-|-|\n| ‚úÖ Deployment successful! <br>[View logs](https://dash.cloudflare.com/?to=/61ecdebdf79feeed43b7e74f65bf1ae8/workers/services/view/gracestowelstorefront-staging/production/builds/e9dc9d1c-2c6e-49cb-bfed-c0a9cb0392bd) | gracestowelstorefront-staging | 683328d5 | <a href='https://71b36b39-gracestowelstorefront-staging.leonshichuan.workers.dev'>Commit Preview URL</a><br><br><a href='https://feat-local-admin-notifications-gracestowelstorefront-staging.leonshichuan.workers.dev'>Branch Preview URL</a> | Jan 20 2026, 03:59 AM |","createdAt":"2026-01-20T01:28:03Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770634627","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv1jq","author":{"login":"gemini-code-assist"},"authorAssociation":"CONTRIBUTOR","body":"## Summary of Changes\n\nHello @builderbuilds123, I'm Gemini Code Assist[^1]! I'm currently reviewing this pull request and will post my feedback shortly. In the meantime, here's a summary to help you and other reviewers quickly get up to speed!\n\nThis pull request significantly enhances the stability, security, and maintainability of the checkout process. It introduces a more modular architecture, predictable state management, and robust error handling. Critical security measures like CSRF protection and input sanitization are now in place, alongside a new password reset feature and comprehensive E2E tests to safeguard the user experience.\n\n### Highlights\n\n* **Checkout Flow Refactoring**: The main checkout route (`checkout.tsx`) has been significantly refactored into smaller, more modular components and hooks. This includes a new `CheckoutProvider` for centralized state management and `CheckoutContent` for UI orchestration, reducing the main route file to just 52 lines.\n* **State Management Migration to useReducer**: Several key checkout-related hooks, including `useCheckoutError`, `useShippingPersistence`, and `usePromoCode`, have been migrated to use the `useReducer` hook for more predictable and robust state transitions.\n* **Comprehensive E2E Test Coverage**: A new end-to-end test suite (`full-checkout.happy.spec.ts`) has been added to cover the complete guest checkout 'happy path' flow, ensuring critical functionality remains stable.\n* **Input Sanitization for Security**: Input sanitization using `DOMPurify` has been implemented on the checkout success page (`checkout.success.tsx`) to protect against Cross-Site Scripting (XSS) vulnerabilities when displaying customer names and addresses.\n* **CSRF Protection for API Routes**: CSRF (Cross-Site Request Forgery) protection has been implemented across all API routes in the storefront, utilizing a double-submit cookie pattern to enhance security.\n* **Password Reset Functionality**: A complete password reset flow has been added, including dedicated 'Forgot Password' and 'Reset Password' pages in the storefront, a new email template, and a backend subscriber to handle password reset requests.\n* **Local Admin Notifications**: A local notification provider has been integrated into the backend, enabling admin notifications for various events such as order placed, order canceled, inventory backorder, fulfillment created, customer created, and payment failed.\n* **Centralized Checkout Constants**: All 'magic numbers' related to checkout timing, timeouts, and cache durations have been extracted into a new `CHECKOUT_CONSTANTS` file for improved maintainability and clarity.\n* **Medusa Cart Integration and Transfer**: A new `MedusaCartProvider` has been introduced to manage the Medusa cart state, ensuring debounced server-side synchronization with the local cart. Additionally, guest carts are now transferred to authenticated users upon login or registration.\n\n\n\n\n\n\n\n\n\n<details>\n<summary><b>Using Gemini Code Assist</b></summary>\n<br>\n\nThe full guide for Gemini Code Assist can be found on our [documentation page](https://developers.google.com/gemini-code-assist/docs/review-github-code), here are some quick tips.\n\n<b>Invoking Gemini</b>\n\nYou can request assistance from Gemini at any point by creating a comment using either `/gemini <command>` or `@gemini-code-assist <command>`. Below is a summary of the supported commands on the current page.\n\nFeature | Command | Description\n--- | --- | ---\nCode Review | `/gemini review` | Performs a code review for the current pull request in its current state.\nPull Request Summary | `/gemini summary` | Provides a summary of the current pull request in its current state.\nComment | @gemini-code-assist | Responds in comments when explicitly tagged, both in pull request comments and review comments.\nHelp | `/gemini help` | Displays a list of available commands.\n\n<b>Customization</b>\n\nTo customize Gemini Code Assist for GitHub experience, repository maintainers can create a configuration file and/or provide a custom code review style guide (such as PEP-8 for Python) by creating and adding files to a `.gemini/` folder in the base of the repository. Detailed instructions can be found [here](https://developers.google.com/gemini-code-assist/docs/customize-gemini-behavior-github).\n\n<b>Limitations & Feedback</b>\n\nGemini Code Assist may make mistakes. Please leave feedback on any instances where its feedback is incorrect or counter productive. You can react with :thumbsup: and :thumbsdown: on @gemini-code-assist comments. If you're interested in giving your feedback about your experience with Gemini Code Assist for Github and other Google products, sign up [here](https://google.qualtrics.com/jfe/form/SV_2cyuGuTWsEw84yG).\n\n<b>You can also get AI-powered code generation, chat, as well as code reviews directly in the IDE at no cost with the [Gemini Code Assist IDE Extension](https://cloud.google.com/products/gemini/code-assist).</b>\n</details>\n\n\n\n\n[^1]: Review the [Privacy Notices](https://policies.google.com/privacy), [Generative AI Prohibited Use Policy](https://policies.google.com/terms/generative-ai/use-policy), [Terms of Service](https://policies.google.com/terms), and learn how to configure Gemini Code Assist in GitHub [here](https://developers.google.com/gemini-code-assist/docs/customize-gemini-behavior-github). Gemini can make mistakes, so double check it and [use code with caution](https://support.google.com/legal/answer/13505487).\n","createdAt":"2026-01-20T01:29:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770636522","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv1-A","author":{"login":"deepsource-io"},"authorAssociation":"NONE","body":"<div><p>Here's the code health analysis summary for commits <code>cf6d0f8..683328d</code>. <a href=\"https://app.deepsource.com/gh/builderbuilds123/gracestowel/run/56a2048e-69e0-4371-86bd-a591b4def5e1/\">View details on DeepSource</a>&nbsp;‚Üó.</p><h3>Analysis Summary</h3><table><thead><tr><th>Analyzer</th><th>Status</th><th>Summary</th><th>Link</th></tr></thead><tbody><tr><td><img src=\"https://static.deepsource.com/analyzer_logos/javascript.svg\" alt=\"DeepSource JavaScript Logo\" width=\"16px\" height=\"16px\"/><strong>JavaScript</strong></td><td><span>‚ùå&nbsp;</span><span>Failure</span></td><td><div>‚ùó 132 occurences introduced</div><div>üéØ 34 occurences resolved</div></td><td><a href=\"https://app.deepsource.com/gh/builderbuilds123/gracestowel/run/56a2048e-69e0-4371-86bd-a591b4def5e1/javascript/\">View Check</a>&nbsp;‚Üó</td></tr></tbody></table><hr/><blockquote><div>üí° If you‚Äôre a repository administrator, you can configure the quality gates from the <a href=\"https://app.deepsource.com/gh/builderbuilds123/gracestowel/settings/reporting\">settings</a>.</div></blockquote></div>\n","createdAt":"2026-01-20T01:30:21Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770638208","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv2_w","author":{"login":"builderbuilds123"},"authorAssociation":"OWNER","body":"@codex code review","createdAt":"2026-01-20T01:32:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770642416","viewerDidAuthor":true},{"id":"IC_kwDOQZPgfs7gv3VK","author":{"login":"qodo-code-review"},"authorAssociation":"CONTRIBUTOR","body":"## PR Compliance Guide üîç\n\n\n<!-- https://github.com/builderbuilds123/gracestowel/commit/0f99028c76fba612b308b1c5e2491e08751854f5 -->\nBelow is a summary of compliance checks for this PR:<br>\n<table><tbody><tr><td colspan='2'><strong>Security Compliance</strong></td></tr>\n<tr><td rowspan=1>‚ö™</td>\n<td><details><summary><strong>Weak CSRF secret\n</strong></summary><br>\n\n<b>Description:</b> CSRF protection relies on predictable fallback secrets (<code>\"default-secret\"</code> in the CSRF <br>cookie signer and <code>\"dev-secret-key\"</code> used by multiple route handlers), which can allow an <br>attacker to forge a signed CSRF cookie/token pair and bypass CSRF checks if production <br>secrets are misconfigured or missing.<br> <strong><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-6af86bdbc8a672c47f183457c317a76acd86c75e652dd485f36945d7b37ce884R3-R39'>csrf.server.ts [3-39]</a></strong><br>\n\n<details open><summary>Referred Code</summary>\n\n```typescript\nexport const getCSRFCookie = (secret?: string) => createCookie(\"csrf_token\", {\n  path: \"/\",\n  httpOnly: true,\n  secure: process.env.NODE_ENV === \"production\" || import.meta.env.PROD,\n  sameSite: \"lax\",\n  secrets: [secret || \"default-secret\"], // Fallback for dev, but should be provided\n  maxAge: 60 * 60 * 24, // 1 day\n});\n\nexport async function createCSRFToken(request: Request, secret?: string) {\n    const cookie = getCSRFCookie(secret);\n    const cookieHeader = request.headers.get(\"Cookie\");\n    const session = (await cookie.parse(cookieHeader)) || {};\n\n    let token = session.token;\n    const headers = new Headers();\n\n    if (!token) {\n        token = crypto.randomUUID();\n        headers.append(\"Set-Cookie\", await cookie.serialize({ token }));\n    }\n\n\n\n ... (clipped 16 lines)\n```\n\n</details></details></td></tr>\n<tr><td colspan='2'><strong>Ticket Compliance</strong></td></tr>\n<tr><td>‚ö™</td><td><details><summary>üé´ <strong>No ticket provided </strong></summary>\n\n\n- [ ] Create ticket/issue <!-- /create_ticket --create_ticket=true -->\n\n</details></td></tr>\n<tr><td colspan='2'><strong>Codebase Duplication Compliance</strong></td></tr>\n<tr><td>‚ö™</td><td><details><summary><strong>Codebase context is not defined </strong></summary>\n\n\nFollow the <a href='https://qodo-merge-docs.qodo.ai/core-abilities/rag_context_enrichment/'>guide</a> to enable codebase context checks.\n\n</details></td></tr>\n<tr><td colspan='2'><strong>Custom Compliance</strong></td></tr>\n<tr><td rowspan=2>üî¥</td>\n<td><details>\n<summary><strong>Generic: Secure Error Handling</strong></summary><br>\n\n**Objective:** To prevent the leakage of sensitive system information through error messages while <br>providing sufficient detail for internal debugging.<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-2927e0da3cfa3af7d388df390afa9ad0f7fba52ca1b6266d87974a9a18166c96R32-R40'><strong>Error detail leaked</strong></a>: The API response returns raw upstream <code>error.message</code> in <code>details</code>, which can expose internal <br>implementation/system information to end users.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\n} catch (error: any) {\n  console.error(`Error transferring cart ${cartId}:`, error);\n\n  // Check if it's already transferred or other client error\n  const status = error.status || 500;\n  return data({ \n    error: \"Failed to transfer cart\", \n    details: error.message \n  }, { status });\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n<tr><td><details>\n<summary><strong>Generic: Secure Logging Practices</strong></summary><br>\n\n**Objective:** To ensure logs are useful for debugging and auditing without exposing sensitive <br>information like PII, PHI, or cardholder data.<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-07988b917b6f6874f63df1f61ca45c7722aafd3a6bc68189c7a75913740da8e0R55-R55'><strong>PII in logs</strong></a>: The password reset subscriber logs the customer&#x27;s email address directly, introducing <br>PII into logs.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\n  logger.info(`[PASSWORD_RESET] Reset email queued for ${customer.email}`)\n}\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n<tr><td rowspan=4>‚ö™</td>\n<td><details>\n<summary><strong>Generic: Comprehensive Audit Trails</strong></summary><br>\n\n**Objective:** To create a detailed and reliable record of critical system actions for security analysis <br>and compliance.<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-07988b917b6f6874f63df1f61ca45c7722aafd3a6bc68189c7a75913740da8e0R11-R56'><strong>Missing audit context</strong></a>: Password reset handling is logged but the diff does not show a consistent audit-trail <br>record containing actor identity/outcome context for the security-sensitive action.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\nexport default async function customerPasswordResetHandler({\n  event: { data },\n  container,\n}: SubscriberArgs<PasswordResetEventData>) {\n  const logger = container.resolve(\"logger\")\n\n  // Only handle customer password resets\n  if (data.actor_type !== \"customer\") {\n    return\n  }\n\n  // Get customer email\n  const query = container.resolve(\"query\")\n  const { data: customers } = await query.graph({\n    entity: \"customer\",\n    fields: [\"id\", \"email\", \"first_name\"],\n    filters: { id: data.entity_id },\n  })\n\n  if (!customers?.length) {\n    logger.error(`[PASSWORD_RESET] Customer not found: ${data.entity_id}`)\n\n\n ... (clipped 25 lines)\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n<tr><td><details>\n<summary><strong>Generic: Meaningful Naming and Self-Documenting Code</strong></summary><br>\n\n**Objective:** Ensure all identifiers clearly express their purpose and intent, making code <br>self-documenting<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-d4a49b063b26a6e523dbd4c2249cb4c9f23b1428059f4105485a0278d6593a27R79-R83'><strong>Overuse of any</strong></a>: The new <code>useShippingRates</code> API uses <code>address: any</code> and <code>error: any</code>, which reduces <br>self-documentation and type clarity for important checkout data.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\nconst fetchShippingRates = useCallback(async (\n  items: CartItem[],\n  address: any,\n  currentTotal: number,\n  guestEmail?: string,\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n<tr><td><details>\n<summary><strong>Generic: Robust Error Handling and Edge Case Management</strong></summary><br>\n\n**Objective:** Ensure comprehensive error handling that provides meaningful context and graceful <br>degradation<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-d4a49b063b26a6e523dbd4c2249cb4c9f23b1428059f4105485a0278d6593a27R311-R316'><strong>Partial abort handling</strong></a>: Aborted requests are silently returned without resetting error state via <code>onCartSyncError</code>, <br>which may leave stale UI errors depending on parent behavior not visible in the diff.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\n} catch (error: any) {\n  if (error.name === 'AbortError') {\n    return;\n  }\n  logger.error('Shipping rates error', error as Error);\n  onCartSyncError?.(error.message);\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n<tr><td><details>\n<summary><strong>Generic: Security-First Input Validation and Data Handling</strong></summary><br>\n\n**Objective:** Ensure all data inputs are validated, sanitized, and handled securely to prevent <br>vulnerabilities<br>\n\n**Status:** <br><a href='https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-2927e0da3cfa3af7d388df390afa9ad0f7fba52ca1b6266d87974a9a18166c96R14-R20'><strong>Weak CSRF secret fallback</strong></a>: CSRF validation falls back to a hardcoded <code>dev-secret-key</code> when <code>JWT_SECRET</code> is missing, which <br>may weaken protection if misconfigured in non-dev environments.<br>\n<details open><summary>Referred Code</summary>\n\n```typescript\n// CSRF Check\nconst env = context.cloudflare.env as any;\nconst jwtSecret = env.JWT_SECRET || \"dev-secret-key\";\nconst isValidCSRF = await validateCSRFToken(request, jwtSecret);\nif (!isValidCSRF) {\n  return data({ error: \"Invalid CSRF token\" }, { status: 403 });\n}\n```\n\n</details>\n\n> Learn more about managing compliance <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#configuration-options'>generic rules</a> or creating your own <a href='https://qodo-merge-docs.qodo.ai/tools/compliance/#custom-compliance'>custom rules</a>\n</details></td></tr>\n\n<tr><td align=\"center\" colspan=\"2\">\n\n- [ ] Update <!-- /compliance --update_compliance=true -->\n\n</td></tr></tbody></table>\n<details><summary>Compliance status legend</summary>\nüü¢ - Fully Compliant<br>\nüü° - Partial Compliant<br>\nüî¥ - Not Compliant<br>\n‚ö™ - Requires Further Human Verification<br>\nüè∑Ô∏è - Compliance label<br>\n</details>","createdAt":"2026-01-20T01:33:37Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770643786","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv3yq","author":{"login":"builderbuilds123"},"authorAssociation":"OWNER","body":"@claude code review","createdAt":"2026-01-20T01:34:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770645674","viewerDidAuthor":true},{"id":"IC_kwDOQZPgfs7gv32I","author":{"login":"qodo-code-review"},"authorAssociation":"CONTRIBUTOR","body":"## PR Code Suggestions ‚ú®\n\n<!-- 0f99028 -->\n\nExplore these optional code suggestions:\n\n<table><thead><tr><td><strong>Category</strong></td><td align=left><strong>Suggestion&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </strong></td><td align=center><strong>Impact</strong></td></tr><tbody><tr><td rowspan=2>Security</td>\n<td>\n\n\n\n<details><summary>Prevent prototype pollution vulnerability</summary>\n\n___\n\n**Prevent a prototype pollution vulnerability in the <code>sanitizeAddress</code> function by <br>adding a check to skip keys named <code>__proto__</code>, <code>constructor</code>, or <code>prototype</code>.**\n\n[apps/storefront/app/utils/sanitize.ts [31-45]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-1b8f458e3883bf35e838baa838ca4845e45e44077d7f2131022b23b74918aa3bR31-R45)\n\n```diff\n     export function sanitizeAddress<T extends Record<string, unknown>>(address: T): T {\n       const sanitized: Record<string, unknown> = {};\n       \n       for (const [key, value] of Object.entries(address)) {\n+        if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n+          continue;\n+        }\n         if (typeof value === 'string') {\n           sanitized[key] = sanitize(value);\n         } else if (value !== null && typeof value === 'object') {\n           sanitized[key] = sanitizeAddress(value as Record<string, unknown>);\n         } else {\n           sanitized[key] = value;\n         }\n       }\n       \n       return sanitized as T;\n     }\n```\n\n\n\n`[To ensure code accuracy, apply this suggestion manually]`\n\n\n<details><summary>Suggestion importance[1-10]: 9</summary>\n\n__\n\nWhy: The suggestion correctly identifies a critical prototype pollution vulnerability in the recursive `sanitizeAddress` function and provides an effective fix, which is essential for application security.\n\n\n</details></details></td><td align=center>High\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Sanitize error message to prevent XSS</summary>\n\n___\n\n**Sanitize the <code>error.message</code> in <code>CheckoutErrorBanner</code> using <code>DOMPurify</code> before <br>rendering to prevent potential Cross-Site Scripting (XSS) vulnerabilities.**\n\n[apps/storefront/app/hooks/useCheckoutError.tsx [264-295]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-809410d57baf4f73a0d4c13048478207ebe3ac90e4e74a641e6940e595cb092dR264-R295)\n\n```diff\n+import DOMPurify from 'dompurify';\n+\n export function CheckoutErrorBanner({ error }: { error: CheckoutError }) {\n   const bgColor = {\n     error: 'bg-red-50 border-red-200 text-red-700',\n     warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',\n     info: 'bg-blue-50 border-blue-200 text-blue-700',\n   }[error.severity];\n \n   const icon = {\n     error: '‚ùå',\n     warning: '‚ö†Ô∏è',\n     info: '‚ÑπÔ∏è',\n   }[error.severity];\n \n+  const sanitizedMessage = { __html: DOMPurify.sanitize(error.message) };\n+\n   return (\n     <div className={`${bgColor} border px-4 py-3 rounded mb-4`}>\n       <div className=\"flex items-start gap-2\">\n         <span>{icon}</span>\n         <div className=\"flex-1\">\n-          <p className=\"font-medium\">{error.message}</p>\n+          <p className=\"font-medium\" dangerouslySetInnerHTML={sanitizedMessage}></p>\n           {error.action && (\n             <button\n               onClick={error.action.handler}\n               className=\"text-sm underline mt-1 hover:no-underline\"\n             >\n               {error.action.label}\n             </button>\n           )}\n         </div>\n       </div>\n     </div>\n   );\n }\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=1 -->\n\n\n<details><summary>Suggestion importance[1-10]: 9</summary>\n\n__\n\nWhy: The suggestion correctly identifies a potential XSS vulnerability by rendering an unsanitized error message and proposes using `DOMPurify`, which aligns with the PR's security goals.\n\n\n</details></details></td><td align=center>High\n\n</td></tr><tr><td rowspan=5>Possible issue</td>\n<td>\n\n\n\n<details><summary>Fix stale closures in hook</summary>\n\n___\n\n**Add the missing dependencies <code>regionId</code>, <code>setCartId</code>, and <code>onCartUpdated</code> to the <br><code>useCallback</code> dependency array for <code>fetchShippingRates</code> to prevent stale closures.**\n\n[apps/storefront/app/hooks/useShippingRates.ts [322-334]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-d4a49b063b26a6e523dbd4c2249cb4c9f23b1428059f4105485a0278d6593a27R322-R334)\n\n```diff\n     } finally {\n       if (abortControllerRef.current === controller) {\n          setIsCalculating(false);\n       }\n     }\n   }, [\n-    currency, \n-    cartId, \n-    selectedShipping, \n+    currency,\n+    regionId,\n+    cartId,\n+    selectedShipping,\n+    setCartId,\n     setShippingOptions,\n     setSelectedShipping,\n     setIsCalculating,\n     setIsCartSynced,\n     onCartCreated,\n     onCartSynced,\n     onCartSyncError,\n-    logger\n+    onCartUpdated,\n+    logger,\n   ]);\n```\n\n\n\n`[To ensure code accuracy, apply this suggestion manually]`\n\n\n<details><summary>Suggestion importance[1-10]: 8</summary>\n\n__\n\nWhy: The suggestion correctly identifies missing dependencies (`regionId`, `setCartId`, `onCartUpdated`) in the `useCallback` hook, which would cause stale closures and lead to significant bugs in the shipping rate calculation logic.\n\n\n</details></details></td><td align=center>Medium\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Correctly parse JSON in tests</summary>\n\n___\n\n**Update the tests to correctly parse the <code>Response</code> object's body by using <code>await </code><br><code>response.json()</code> instead of incorrectly accessing a non-existent <code>data</code> property.**\n\n[apps/storefront/app/routes/api.carts.$id.complete.test.ts [54-56]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-d3eeae4c05b63d95031b4284cbba1e4ff7a3ecaece2cf969c200368704879941R54-R56)\n\n```diff\n     const response = await action({ request, params: { id: \"cart_123\" }, context } as any);\n-    const data = (response as any).data;\n-    expect(data.error).toBe(\"Method not allowed\");\n+    const responseData = await response.json();\n+    expect(responseData.error).toBe(\"Method not allowed\");\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=3 -->\n\n\n<details><summary>Suggestion importance[1-10]: 7</summary>\n\n__\n\nWhy: This suggestion correctly identifies a fundamental error in the test implementation where the response body is not being properly accessed, rendering the tests ineffective. Fixing this is crucial for ensuring code quality.\n\n\n</details></details></td><td align=center>Medium\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Clear loading on stale request<!-- not_implemented --></summary>\n\n___\n\n**In <code>refreshDiscount</code>, dispatch a <code>SET_LOADING: false</code> action before returning from a <br>stale request check to prevent the UI from getting stuck in a loading state.**\n\n[apps/storefront/app/hooks/usePromoCode.ts [227-244]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-2a284040cc76f1b3ff03fac421209ab2650327a4677f6b60def7f22cf9f060aaR227-R244)\n\n```diff\n dispatch({ type: 'SET_LOADING', payload: true });\n try {\n   const client = getMedusaClient();\n   logger.info('[PromoCode] Refreshing discount from cart', { cartId });\n   const { cart } = await client.store.cart.retrieve(cartId, {\n     fields: '+promotions,+promotions.application_method,+items.adjustments,+shipping_methods.adjustments',\n   });\n   if (currentRequestId !== refreshRequestIdRef.current) {\n     logger.info('[PromoCode] Stale request, skipping', { currentRequestId, latestRequestId: refreshRequestIdRef.current });\n+    dispatch({ type: 'SET_LOADING', payload: false });\n     return;\n   }\n   dispatch({ \n     type: 'SET_DISCOUNT_STATE', \n     payload: getDiscountState(cart as any, logger) \n   });\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=4 -->\n\n\n<details><summary>Suggestion importance[1-10]: 7</summary>\n\n__\n\nWhy: This suggestion correctly identifies a scenario where a stale request could leave the UI in a permanent loading state. The proposed fix ensures the loading state is correctly reset, improving UI robustness.\n\n\n</details></details></td><td align=center>Medium\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Fix race condition in cart creation</summary>\n\n___\n\n**Fix a race condition in the fire-and-forget cart creation by moving the <br><code>cartCreateInFlight.current</code> flag assignment to prevent multiple concurrent API <br>calls.**\n\n[apps/storefront/app/context/CartContext.tsx [128-155]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-fa391458545afb030020fdd288249daa5ebf2105177685d75049309fc435aa97R128-R155)\n\n```diff\n     // Fire-and-forget: ensure a Medusa cart exists on first cart interaction\n-    if (typeof window !== 'undefined' && !cartCreateInFlight.current) {\n+    if (typeof window !== 'undefined' && !cartId && !cartCreateInFlight.current) {\n+        cartCreateInFlight.current = true;\n         void (async () => {\n             try {\n-                if (cartId) {\n-                    return;\n-                }\n-                cartCreateInFlight.current = true;\n                 const response = await monitoredFetch('/api/carts', {\n                     method: 'POST',\n                     headers: { 'Content-Type': 'application/json' },\n                     body: JSON.stringify({ region_id: regionId }),\n                     label: 'create-cart-on-add',\n                 });\n                 if (!response.ok) {\n                     return;\n                 }\n                 const payload = await response.json() as { cart_id?: string };\n                 if (payload.cart_id) {\n                     setCartId(payload.cart_id);\n                 }\n             } catch {\n                 // Non-blocking: cart creation failure should not prevent local cart updates\n             } finally {\n                 cartCreateInFlight.current = false;\n             }\n         })();\n     }\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=5 -->\n\n\n<details><summary>Suggestion importance[1-10]: 7</summary>\n\n__\n\nWhy: The suggestion correctly identifies a potential race condition in the cart creation logic and provides a simple, effective fix that improves the robustness of the feature.\n\n</details></details></td><td align=center>Medium\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Prevent memory leaks with timeout cleanup</summary>\n\n___\n\n**Move the redirect timer into a <code>useEffect</code> hook with a cleanup function to prevent <br>potential memory leaks if the component unmounts before the timer completes.**\n\n[apps/storefront/app/routes/account.reset-password.tsx [33-67]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-e13344a5c818dabd11a1285546e4195da115277ff47822330f385026848bc0efR33-R67)\n\n```diff\n+    useEffect(() => {\n+        if (isSuccess) {\n+            const timer = setTimeout(() => {\n+                navigate('/account/login');\n+            }, 3000);\n+\n+            return () => clearTimeout(timer);\n+        }\n+    }, [isSuccess, navigate]);\n+\n     const handleSubmit = async (e: React.FormEvent) => {\n         e.preventDefault();\n         setError(null);\n \n         if (password !== confirmPassword) {\n             setError('Passwords do not match');\n             return;\n         }\n ...\n         const result = await updatePassword(password, token);\n         \n         if (result.success) {\n             setIsSuccess(true);\n-            // Auto redirect after 3 seconds\n-            setTimeout(() => {\n-                navigate('/account/login');\n-            }, 3000);\n         } else {\n             setError(result.error || 'Failed to reset password. The link may have expired.');\n         }\n         \n         setIsSubmitting(false);\n     };\n```\n\n\n\n`[To ensure code accuracy, apply this suggestion manually]`\n\n\n<details><summary>Suggestion importance[1-10]: 6</summary>\n\n__\n\nWhy: The suggestion correctly identifies a potential memory leak and proposes the standard React solution using `useEffect` with a cleanup function, which improves the component's robustness.\n\n</details></details></td><td align=center>Low\n\n</td></tr><tr><td rowspan=4>General</td>\n<td>\n\n\n\n<details><summary>Clear messages on new operation</summary>\n\n___\n\n**Dispatch a <code>CLEAR_MESSAGES</code> action before setting the loading state in <br><code>applyPromoCode</code> and <code>removePromoCode</code> to clear any stale messages from the UI.**\n\n[apps/storefront/app/hooks/usePromoCode.ts [285]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-2a284040cc76f1b3ff03fac421209ab2650327a4677f6b60def7f22cf9f060aaR285-R285)\n\n```diff\n+dispatch({ type: 'CLEAR_MESSAGES' });\n dispatch({ type: 'SET_LOADING', payload: true });\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=7 -->\n\n\n<details><summary>Suggestion importance[1-10]: 6</summary>\n\n__\n\nWhy: The suggestion improves user experience by ensuring stale success or error messages are cleared when a new promo code operation begins, which is a good practice for UI state management.\n\n\n</details></details></td><td align=center>Low\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Include missing effect dependency</summary>\n\n___\n\n**Add the <code>refreshCart</code> function to the <code>useEffect</code> dependency array to prevent stale <br>closures and ensure the latest function reference is used.**\n\n[apps/storefront/app/context/CartContext.tsx [73-93]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-fa391458545afb030020fdd288249daa5ebf2105177685d75049309fc435aa97R73-R93)\n\n```diff\n useEffect(() => {\n     if (!cartId || !isLoaded) return;\n-\n     const timeoutId = setTimeout(async () => {\n         try {\n             const response = await monitoredFetch(`/api/carts/${cartId}`, {\n                 method: 'PATCH',\n                 headers: { 'Content-Type': 'application/json' },\n                 body: JSON.stringify({ items }),\n                 label: 'sync-cart-items-debounced',\n             });\n             if (response.ok) {\n                 void refreshCart();\n             }\n         } catch (err) {\n             console.error('[CartContext] Failed to sync items with Medusa:', err);\n         }\n     }, 1000);\n+    return () => clearTimeout(timeoutId);\n+}, [items, cartId, isLoaded, refreshCart]);\n \n-    return () => clearTimeout(timeoutId);\n-}, [items, cartId, isLoaded]);\n-\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=8 -->\n\n\n<details><summary>Suggestion importance[1-10]: 5</summary>\n\n__\n\nWhy: The suggestion correctly identifies a missing dependency in the `useEffect` hook. While `refreshCart` is stable due to `useCallback`, adding it to the dependency array is a best practice.\n\n</details></details></td><td align=center>Low\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Log errors in catch block</summary>\n\n___\n\n**Instead of silently ignoring potential errors when clearing <code>sessionStorage</code>, log <br>them to <code>console.error</code> for better debugging.**\n\n[apps/storefront/app/routes/checkout.tsx [39-44]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-de837e3b2176c96d22d60edd1a077b53dc293d6def77373021e3817e59bcca14R39-R44)\n\n```diff\n if (typeof window !== 'undefined') {\n   try {\n     sessionStorage.removeItem('verifiedOrder');\n     sessionStorage.removeItem('lastOrder');\n-  } catch (e) {}\n+  } catch (e) {\n+    console.error(\"Failed to clear session storage on checkout load:\", e);\n+  }\n }\n```\n\n\n\n`[To ensure code accuracy, apply this suggestion manually]`\n\n\n<details><summary>Suggestion importance[1-10]: 4</summary>\n\n__\n\nWhy: The suggestion correctly identifies an empty catch block, which is an anti-pattern, and proposes logging the error to improve debuggability for non-critical operations.\n\n\n</details></details></td><td align=center>Low\n\n</td></tr><tr><td>\n\n\n\n<details><summary>Use structured logging instead of console</summary>\n\n___\n\n**Replace <code>console.log</code> and <code>console.error</code> calls with a structured logger to align <br>with project standards and improve security by preventing untamed error logging.**\n\n[apps/storefront/app/context/CustomerContext.tsx [136-151]](https://github.com/builderbuilds123/gracestowel/pull/165/files#diff-efda6d854254a9816533f4e4ba47726fe9ef00f8b1cae581d8a1f3ecc6ca72daR136-R151)\n\n```diff\n     if (cartId) {\n         try {\n             await monitoredFetch(`/api/carts/${cartId}/transfer`, {\n                 method: 'POST',\n                 headers: {\n                     'Content-Type': 'application/json',\n                     'Authorization': `Bearer ${newToken}`,\n                 },\n                 label: 'cart-transfer-on-login',\n             });\n-            console.log('[CustomerContext] Cart transferred successfully:', cartId);\n+            // logger.info('[CustomerContext] Cart transferred successfully', { cartId });\n         } catch (err) {\n-            console.error('[CustomerContext] Failed to transfer cart during login:', err);\n+            // logger.error('[CustomerContext] Failed to transfer cart during login', { error: err });\n             // Continue anyway, as login was successful\n         }\n     }\n```\n\n\n- [ ] **Apply / Chat** <!-- /improve --apply_suggestion=10 -->\n\n\n<details><summary>Suggestion importance[1-10]: 4</summary>\n\n__\n\nWhy: The suggestion correctly points out that using a structured logger is better practice than `console.log`/`error` for consistency and security, which is a valid code quality improvement.\n\n</details></details></td><td align=center>Low\n\n</td></tr>\n<tr><td align=\"center\" colspan=\"2\">\n\n- [ ] Update <!-- /improve_multi --more_suggestions=true -->\n\n</td><td></td></tr></tbody></table>","createdAt":"2026-01-20T01:34:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770645896","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv34u","author":{"login":"claude"},"authorAssociation":"NONE","body":"**Claude encountered an error** ‚Äî‚Äî [View job](https://github.com/builderbuilds123/gracestowel/actions/runs/21156482477)\n\n---\nI'll analyze this and get back to you.","createdAt":"2026-01-20T01:35:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770646062","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gv5LP","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"## Codacy's Analysis Summary\n**100** new issues (‚â§ 0 issue)\n**4** new security issues\n**228** complexity \n**53** duplications\n\n\n[**Review Pull Request in Codacy ‚Üí**](https://app.codacy.com/gh/builderbuilds123/gracestowel/pull-requests/165?utm_source=github.com&utm_medium=pullRequestSummary&utm_campaign=pullRequestSummary)\n\n##\n> ‚ú® **AI Reviewer available:** add the `codacy-review` label to get contextual insights without leaving GitHub.\n<!-- 082f941e-099e-494a-83c7-b808dccfa8f3 -->","createdAt":"2026-01-20T01:38:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770651343","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gwGA8","author":{"login":"codecov"},"authorAssociation":"NONE","body":"## [Codecov](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) Report\n:x: Patch coverage is `44.55556%` with `499 lines` in your changes missing coverage. Please review.\n| [Files with missing lines](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) | Patch % | Lines |\n|---|---|---|\n| [apps/storefront/app/hooks/useShippingRates.ts](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9ob29rcy91c2VTaGlwcGluZ1JhdGVzLnRz) | 50.00% | [62 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [...s/storefront/app/routes/account.reset-password.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9yb3V0ZXMvYWNjb3VudC5yZXNldC1wYXNzd29yZC50c3g=) | 0.00% | [51 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [apps/storefront/app/context/MedusaCartContext.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9jb250ZXh0L01lZHVzYUNhcnRDb250ZXh0LnRzeA==) | 45.45% | [36 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [apps/storefront/app/utils/csrf.server.ts](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC91dGlscy9jc3JmLnNlcnZlci50cw==) | 2.85% | [34 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [apps/storefront/app/hooks/useCheckoutError.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9ob29rcy91c2VDaGVja291dEVycm9yLnRzeA==) | 34.09% | [29 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [...ps/storefront/app/routes/api.carts.$id.transfer.ts](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9yb3V0ZXMvYXBpLmNhcnRzLiRpZC50cmFuc2Zlci50cw==) | 0.00% | [26 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [apps/storefront/app/context/CustomerContext.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9jb250ZXh0L0N1c3RvbWVyQ29udGV4dC50c3g=) | 13.79% | [25 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [.../storefront/app/routes/account.forgot-password.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9yb3V0ZXMvYWNjb3VudC5mb3Jnb3QtcGFzc3dvcmQudHN4) | 0.00% | [25 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [...efront/app/components/checkout/CheckoutContent.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9jb21wb25lbnRzL2NoZWNrb3V0L0NoZWNrb3V0Q29udGVudC50c3g=) | 55.76% | [23 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| [...front/app/components/checkout/CheckoutProvider.tsx](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123#diff-YXBwcy9zdG9yZWZyb250L2FwcC9jb21wb25lbnRzL2NoZWNrb3V0L0NoZWNrb3V0UHJvdmlkZXIudHN4) | 66.12% | [21 Missing :warning: ](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) |\n| ... and [31 more](https://app.codecov.io/gh/builderbuilds123/gracestowel/pull/165?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=builderbuilds123) | |\n\n:loudspeaker: Thoughts on this report? [Let us know!](https://github.com/codecov/feedback/issues/255)","createdAt":"2026-01-20T02:08:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770703932","viewerDidAuthor":false},{"id":"IC_kwDOQZPgfs7gwdL1","author":{"login":"guardrails"},"authorAssociation":"NONE","body":"\nAll previously detected findings have been fixed. Good job! üëçüéâ\n\nWe will keep this comment up-to-date as you go along and notify you of any security issues that we identify.\n\n\n---\n\nüëâ Go to the [dashboard](https://dashboard.guardrails.io/gh/builderbuilds123/repos/606476/scans?sha=683328d52d0440c24ef3230421275eeceafcb0bf) for detailed results.\n\nüì• Happy? Share your [feedback](https://guardrails.typeform.com/to/BCgBkB) with us.\n","createdAt":"2026-01-20T02:56:24Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/builderbuilds123/gracestowel/pull/165#issuecomment-3770798837","viewerDidAuthor":false}],"reviews":[{"id":"PRR_kwDOQZPgfs7bWEph","author":{"login":"github-advanced-security"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T01:28:33Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"0f99028c76fba612b308b1c5e2491e08751854f5"}},{"id":"PRR_kwDOQZPgfs7bWFeu","author":{"login":"gemini-code-assist"},"authorAssociation":"CONTRIBUTOR","body":"## Code Review\n\nThis is an excellent pull request that significantly refactors and improves the checkout flow. The modularization of `checkout.tsx` into a clean orchestrator with `CheckoutProvider` and `CheckoutContent` is a huge improvement for maintainability. Migrating state management hooks (`useCheckoutError`, `useShippingPersistence`, `usePromoCode`) to `useReducer` makes state transitions more predictable and robust.\n\nThe feature additions are also very valuable:\n- A full 'Happy Path' E2E test provides great confidence in the checkout flow.\n- The implementation of admin notifications for key events will greatly improve operational visibility.\n- The addition of a secure password reset flow is a critical feature for customer account management.\n- Implementing CSRF protection across all API routes is a major security enhancement.\n- Input sanitization on the checkout success page is a great step towards preventing XSS vulnerabilities.\n\nI have a few minor suggestions to further improve the code, but overall this is a very strong contribution. Great work!","submittedAt":"2026-01-20T01:31:15Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"0f99028c76fba612b308b1c5e2491e08751854f5"}},{"id":"PRR_kwDOQZPgfs7bWG7g","author":{"login":"chatgpt-codex-connector"},"authorAssociation":"NONE","body":"\n### üí° Codex Review\n\nHere are some automated review suggestions for this pull request.\n\n**Reviewed commit:** `0f99028c76`\n    \n\n<details> <summary>‚ÑπÔ∏è About Codex in GitHub</summary>\n<br/>\n\n[Your team has set up Codex to review pull requests in this repo](http://chatgpt.com/codex/settings/general). Reviews are triggered when you\n- Open a pull request for review\n- Mark a draft as ready\n- Comment \"@codex review\".\n\nIf Codex has suggestions, it will comment; otherwise it will react with üëç.\n\n\n\n\nCodex can also answer questions or update the PR. Try commenting \"@codex address that feedback\".\n            \n</details>","submittedAt":"2026-01-20T01:36:08Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"0f99028c76fba612b308b1c5e2491e08751854f5"}},{"id":"PRR_kwDOQZPgfs7bWKMC","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"**Actionable comments posted: 13**\n\n> [!NOTE]\n> Due to the large number of review comments, Critical, Major severity comments were prioritized as inline comments.\n\n> [!CAUTION]\n> Some comments are outside the diff and can‚Äôt be posted inline due to platform limitations.\n> \n> \n> \n> <details>\n> <summary>‚ö†Ô∏è Outside diff range comments (6)</summary><blockquote>\n> \n> <details>\n> <summary>apps/backend/src/workers/payment-capture-worker.ts (1)</summary><blockquote>\n> \n> `881-910`: **Use nullish coalescing and explicit minimum for clearer retry-limit logic.**\n> \n> The code currently relies on `job?.opts?.attempts || 3`, which works correctly because the queue's `defaultJobOptions` always sets `attempts: 3`. However, if the queue default changes or is removed, using `||` could hide a configuration bug where `attempts` is unexpectedly 0. The suggested fix improves clarity and robustness:\n> \n> <details>\n> <summary>üîß Suggested fix</summary>\n> \n> ```diff\n> -        const maxAttempts = job?.opts?.attempts || 3;\n> +        const maxAttempts = Math.max(job?.opts?.attempts ?? 1, 1);\n> ```\n> </details>\n> \n> This change:\n> - Uses `??` (nullish coalescing) to only treat `null`/`undefined` as missing, not `0`\n> - Explicitly ensures attempts is never less than 1\n> - Makes the intent clearer and guards against queue misconfiguration\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/backend/src/modules/resend/service.ts (1)</summary><blockquote>\n> \n> `9-27`: **Redact password‚Äëreset payloads from email debug logs.**\n> \n> With the new password‚Äëreset template, `notification.data` will likely include a reset URL/token; the current debug logging would leak it.\n> \n> \n> <details>\n> <summary>üîí Suggested redaction</summary>\n> \n> ```diff\n> -      console.log(`Data: ${JSON.stringify(notification.data, null, 2)}`)\n> +      const logData =\n> +        notification.template === Templates.PASSWORD_RESET && notification.data\n> +          ? { ...(notification.data as Record<string, unknown>), reset_url: \"[REDACTED]\" }\n> +          : notification.data\n> +      console.log(`Data: ${JSON.stringify(logData, null, 2)}`)\n> ```\n> </details>\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/storefront/app/routes/api.shipping-rates.ts (1)</summary><blockquote>\n> \n> `264-279`: **Dead code: `regionOptions` is fetched but never used.**\n> \n> The `regionOptions` array is populated from the API response (lines 273-274) but is never referenced in the `formattedOptions` mapping (lines 281-289) or elsewhere. This fetch adds unnecessary latency.\n> \n> \n> \n> <details>\n> <summary>Options to resolve</summary>\n> \n> Either remove the unused fetch:\n> ```diff\n> -    let regionOptions: any[] = [];\n> -    if (regionId) {\n> -        try {\n> -            const optionsResponse = await medusaFetch(`/store/shipping-options?region_id=${regionId}`, {\n> -                method: \"GET\",\n> -                label: \"medusa-shipping-options-enrich\",\n> -                context,\n> -            });\n> -            if (optionsResponse.ok) {\n> -                const data = await optionsResponse.json() as { shipping_options: any[] };\n> -                regionOptions = data.shipping_options;\n> -            }\n> -        } catch (e) {\n> -            logger.warn(\"Failed to fetch region options for enrichment\", { error: e });\n> -        }\n> -    }\n> ```\n> \n> Or use `regionOptions` for enrichment as the comments suggest (lines 241-254) to provide `originalAmount`.\n> </details>\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/storefront/app/services/medusa-cart.ts (1)</summary><blockquote>\n> \n> `325-335`: **Remove retry wrapper from `transferCart` or add error code filtering.**\n> \n> Medusa v2's POST /store/carts/:id/customer transfer endpoint is not marked as idempotent in official documentation. Retrying a non-idempotent state-change operation on transient failures risks duplicate or conflicting transfers. The codebase already demonstrates selective retry logic elsewhere (e.g., `getCart` skips 404 retries; `addShippingMethod` skips 4xx retries), making the unconditional retry here inconsistent and unsafe.\n> \n> Either remove the retry wrapper entirely, or add conditional error handling to only retry 5xx/transient errors:\n> \n> <details>\n> <summary>üîß Suggested fix (remove retry for non-idempotent transfer)</summary>\n> \n> ```diff\n>   async transferCart(cartId: string): Promise<Cart> {\n> -   return retry(async () => {\n> -     try {\n> -       const { cart } = await this.client.store.cart.transfer(cartId);\n> -       return cart;\n> -     } catch (error: any) {\n> -       this.logger.error(`Error transferring cart ${cartId}`, error);\n> -       throw error;\n> -     }\n> -   });\n> + try {\n> +   const { cart } = await this.client.store.cart.transfer(cartId);\n> +   return cart;\n> + } catch (error: any) {\n> +   this.logger.error(`Error transferring cart ${cartId}`, error);\n> +   throw error;\n> + }\n>   }\n> ```\n> </details>\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/storefront/app/routes/checkout.test.tsx (2)</summary><blockquote>\n> \n> `152-154`: **Duplicate assertion.**\n> \n> Lines 153 and 154 are identical assertions. Remove the duplicate.\n> \n> \n> \n> <details>\n> <summary>üßπ Remove duplicate assertion</summary>\n> \n> ```diff\n>         // Should NOT fire yet\n> -       // Should NOT fire yet\n>         expect(mockPostHog.capture).not.toHaveBeenCalled();\n> -       expect(mockPostHog.capture).not.toHaveBeenCalled();\n> ```\n> </details>\n> \n> ---\n> \n> `399-405`: **Missing `isLoaded: true` in mock, unlike other test cases.**\n> \n> This test case is missing `isLoaded: true` in the `mockUseCart` return value, while all other test cases include it. This inconsistency may cause the test to pass for the wrong reason (component showing loading state instead of testing the intended failure path).\n> \n> \n> \n> <details>\n> <summary>üêõ Add missing isLoaded property</summary>\n> \n> ```diff\n>         mockUseCart.mockReturnValue({\n>             items: [{ id: '1', title: 'Towel', price: 1000, quantity: 1 }],\n>             cartTotal: 1000,\n>             updateQuantity: vi.fn(),\n>             removeFromCart: vi.fn(),\n> +           isLoaded: true,\n>         });\n> ```\n> </details>\n> \n> </blockquote></details>\n> \n> </blockquote></details>\n\n<details>\n<summary>ü§ñ Fix all issues with AI agents</summary>\n\n```\nIn `@apps/storefront/app/components/checkout/PaymentSection.tsx`:\n- Around line 8-20: The PaymentElement options use incorrect layout syntax; in\nthe PaymentSection component change the options passed to PaymentElement so\nlayout is an object with a type property (e.g., options={{ layout: { type:\n'tabs' } }}) instead of a string; update the PaymentElement call in\nPaymentSection to pass options={{ layout: { type: 'tabs' } }} (valid types:\n'accordion' | 'tabs').\n\nIn `@apps/storefront/app/context/CartContext.tsx`:\n- Around line 198-199: displayCartTotal currently mixes formats:\nmedusaCart.subtotal is in cents while calculateTotal(items) returns decimals;\nchange the selection to normalize formats before assignment (e.g., if you want\ndisplayCartTotal in dollars, use medusaCart?.subtotal when present divided by\n100, otherwise calculateTotal(items); or if you prefer cents, multiply\ncalculateTotal(items) by 100). Update the expression that sets displayCartTotal\n(the line with const displayCartTotal = medusaCart?.subtotal ??\ncalculateTotal(items);) to perform the appropriate conversion so both branches\nuse the same unit.\n\nIn `@apps/storefront/app/context/MedusaCartContext.tsx`:\n- Around line 92-110: The effect in MedusaCartContext.tsx may repeatedly PATCH\nthe cart because refreshCart updates cart and re-triggers the effect; add a\nguard using a ref (e.g., syncingRegionRef) to track an in-flight target region\nand skip starting a new PATCH if syncingRegionRef.current === regionId; set\nsyncingRegionRef.current = regionId before calling monitoredFetch (and clear it\nafter success/failure), and still call refreshCart on success‚Äîthis prevents\nredundant requests while keeping the existing logic in useEffect, monitoredFetch\ncall, and refreshCart invocation.\n\nIn `@apps/storefront/app/root.tsx`:\n- Line 94: The code currently uses a hardcoded fallback \"dev-secret-key\" for\njwtSecret which is unsafe in production; update the logic around jwtSecret to\ndetect production (via NODE_ENV or similar), and if JWT_SECRET is missing then\neither throw an error or at minimum log a loud warning and halt startup in\nproduction, otherwise fall back to a development-only secret; compute an\neffectiveSecret variable from this logic and pass effectiveSecret into\ncreateCSRFToken (and any other JWT/CSRF usages) instead of the hardcoded\njwtSecret to ensure production never silently uses the weak default.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.complete.ts:\n- Around line 17-23: Remove the unused CloudflareEnv import, stop casting env to\nany, and require JWT_SECRET to be present: read jwtSecret from\ncontext.cloudflare.env (use a safe non-any typing such as unknown or\nRecord<string,string>, not CloudflareEnv import), and if jwtSecret is missing or\nempty return a 500 (or throw) with a clear message like \"JWT_SECRET not\nconfigured\" instead of using the \"dev-secret-key\" fallback; keep the CSRF check\nthat calls validateCSRFToken(request, jwtSecret) unchanged but ensure jwtSecret\nis validated before calling it.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.shipping-methods.ts:\n- Around line 30-36: Don't use the hardcoded \"dev-secret-key\" fallback for\nJWT_SECRET; instead ensure the route checks context.cloudflare.env.JWT_SECRET\nexists and if missing (and NODE_ENV !== \"development\") return or throw a\n500/secure error before calling validateCSRFToken; remove the fallback default,\nuse the real secret variable (env.JWT_SECRET) when invoking validateCSRFToken,\nand include a clear error path so validateCSRFToken is never called with a weak\ndefault secret.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.transfer.ts:\n- Around line 14-20: The CSRF check uses a hardcoded fallback \"dev-secret-key\"\nfor jwtSecret which weakens security; update the initialization of jwtSecret (in\nthe block using env and jwtSecret before calling validateCSRFToken) to fail fast\nin production by throwing an error or returning a 500 if env.JWT_SECRET is\nmissing, and otherwise use the provided secret; optionally log a clear warning\nwhen running in a non-production environment without a secret. Ensure the change\nis applied where jwtSecret is defined and before validateCSRFToken is called so\nvalidateCSRFToken never receives a predictable fallback in production.\n- Around line 27-31: The route calls MedusaCartService.transferCart without\nverifying the customer's authentication; ensure the request is authenticated\nbefore performing the transfer by checking the customer's session/auth token\n(e.g., from context.request, cookies, or auth middleware) and return a 401 if\nabsent, or alternately initialize MedusaCartService with the authenticated\ncustomer context/token so transferCart receives the customer's credentials;\nupdate the route handler to either perform the auth check and reject\nunauthorized requests or pass the customer auth into\nMedusaCartService/transferCart accordingly.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.ts:\n- Around line 51-57: Currently the code falls back to a hardcoded\n\"dev-secret-key\" when env.JWT_SECRET is missing which is insecure; update the\nCSRF secret handling in the block that reads env.JWT_SECRET and calls\nvalidateCSRFToken so that if JWT_SECRET is absent and the runtime is not a\ndevelopment environment (check NODE_ENV or an equivalent env flag) the handler\nfails explicitly (respond with an error/500 or throw) instead of using the\nfallback; keep using validateCSRFToken with the real jwtSecret when present and\nonly allow the hardcoded fallback in a verified development-only path.\n\nIn `@apps/storefront/app/routes/api.payment-collections`.$id.sessions.ts:\n- Around line 27-33: The CSRF check currently falls back to \"dev-secret-key\"\nwhich is insecure; change the jwtSecret retrieval (the jwtSecret variable\nderived from context.cloudflare.env) to fail explicitly when JWT_SECRET is\nabsent in non-development environments: if env.JWT_SECRET is missing and the\nruntime is not dev, return an error/throw (e.g., 500 or 401) instead of using a\nhardcoded secret, then pass the real secret to validateCSRFToken(request,\njwtSecret); update the error path that uses data(...) and preserve traceId for\nlogging.\n\nIn `@apps/storefront/app/routes/api.payment-collections.ts`:\n- Around line 44-45: The code currently falls back to a hardcoded\n\"dev-secret-key\" when env.JWT_SECRET is missing; update the logic around the\njwtSecret variable to avoid using a production fallback: check environment via\nenv.NODE_ENV (or another deployment flag) and if JWT_SECRET is missing and\nNODE_ENV !== \"development\" then throw an error or return a clear 5xx response\nand log the problem; only allow the \"dev-secret-key\" fallback when NODE_ENV ===\n\"development\". Update the jwtSecret assignment and the surrounding\ninitialization in the api.payment-collections route to implement this\nconditional check and error handling.\n\nIn `@apps/storefront/app/utils/csrf.server.ts`:\n- Line 8: Remove the hardcoded \"default-secret\" fallback and ensure the app\nfails loudly in non-dev environments: in the code that builds the secrets array\n(the variable/parameter named secrets or secret in csrf.server.ts, used when\ncreating the cookie/session storage), if the secret is missing and\nprocess.env.NODE_ENV !== \"development\" throw an error (or at minimum log a\nclear, high-severity warning and exit); for development only, you may keep a\ndev-only fallback but guard it behind NODE_ENV === \"development\" so production\nnever uses a predictable secret.\n\nIn `@apps/storefront/app/utils/monitored-fetch.ts`:\n- Around line 269-280: The current CSRF protection treats protocol-relative URLs\n(e.g., //evil.com) as relative because isRelative is computed with\n!url.startsWith('http'), which can leak the X-CSRF-Token; change the origin\ncheck in monitored-fetch.ts to construct a URL object (e.g., new URL(url,\nwindow.location.href)) and compare urlObj.origin === window.location.origin (or\nuse urlObj.hostname and protocol) before setting X-CSRF-Token on\nfetchOptions.headers so only truly same-origin requests (determined by URL\nparsing) receive the token.\n```\n\n</details>\n\n<details>\n<summary>‚ôªÔ∏è Duplicate comments (4)</summary><blockquote>\n\n<details>\n<summary>apps/backend/src/subscribers/customer-password-reset.ts (1)</summary><blockquote>\n\n`41-42`: **Fallback URL concern already noted.**\n\nThe `STOREFRONT_URL` fallback to `localhost:3000` in production has been flagged in a prior review. Ensure this environment variable is set in production deployments.\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (1)</summary><blockquote>\n\n`23-23`: **Use standard `.click()` instead of `evaluate()`.**\n\nThis has been noted in prior review. Using `evaluate(el => el.click())` bypasses Playwright's actionability checks (visibility, stability, enabled state), which can lead to flaky tests.\n\n\n\n\nAlso applies to: 30-30\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/admin-notifications.ts (1)</summary><blockquote>\n\n`21-21`: **Logger typed as `any` reduces type safety.**\n\nThis concern was already flagged in a previous review. Consider defining a minimal logger interface or using the actual Logger type from Medusa.\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary><blockquote>\n\n`55-70`: **Logging appropriately masks sensitive data.**\n\nThe `maskEmail` utility is correctly applied to protect the recipient's email address. Regarding the static analysis hint about \"clear-text logging of sensitive information\" ‚Äî this appears to be a false positive. The log at line 66 outputs the template name (e.g., `Templates.PASSWORD_RESET`, which is just an enum string like `\"password-reset\"`) and the masked email, not actual password reset tokens or credentials.\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üü° Minor comments (12)</summary><blockquote>\n\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-3-address-management.md-323-324 (1)</summary><blockquote>\n\n`323-324`: **Fix heading level jump.**\n\n`#### Created` jumps a level; markdownlint expects `###` here.  \n\n<details>\n<summary>üí° Suggested fix</summary>\n\n```diff\n-#### Created\n+### Created\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-3-address-management.md-245-283 (1)</summary><blockquote>\n\n`245-283`: **Add a language identifier to fenced UI mockups.**\n\nThe fenced blocks under ‚ÄúAddresses Tab‚Äù and ‚ÄúEmpty State‚Äù are missing a language, which trips markdownlint MD040. Use `text` or `plaintext`.  \n\n<details>\n<summary>üí° Suggested fix</summary>\n\n```diff\n-```\n+```text\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n...\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n-```\n+```\n\n...\n\n-```\n+```text\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n...\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n-```\n+```\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/utils/sanitize.ts-31-44 (1)</summary><blockquote>\n\n`31-44`: **Arrays are not recursively sanitized.**\n\nThe recursive sanitization handles nested objects but treats arrays as plain objects. If an address contains array fields with string elements (e.g., `address_lines: [\"<script>evil</script>\"]`), those strings won't be sanitized.\n\n\n<details>\n<summary>üîß Proposed fix to handle arrays</summary>\n\n```diff\n export function sanitizeAddress<T extends Record<string, unknown>>(address: T): T {\n   const sanitized: Record<string, unknown> = {};\n   \n   for (const [key, value] of Object.entries(address)) {\n     if (typeof value === 'string') {\n       sanitized[key] = sanitize(value);\n+    } else if (Array.isArray(value)) {\n+      sanitized[key] = value.map(item => \n+        typeof item === 'string' ? sanitize(item) :\n+        item !== null && typeof item === 'object' ? sanitizeAddress(item as Record<string, unknown>) :\n+        item\n+      );\n     } else if (value !== null && typeof value === 'object') {\n       sanitized[key] = sanitizeAddress(value as Record<string, unknown>);\n     } else {\n       sanitized[key] = value;\n     }\n   }\n   \n   return sanitized as T;\n }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/package.json-27-27 (1)</summary><blockquote>\n\n`27-27`: **LGTM ‚Äî DOMPurify 3.3.1 is current; remove `@types/dompurify` (deprecated).**\n\nDOMPurify 3.3.1 is the latest version and a solid choice for XSS sanitization. However, `@types/dompurify` is deprecated‚Äîdompurify v3+ includes its own type definitions, making the separate `@types` package unnecessary. Remove the `@types/dompurify` devDependency at line 49.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/CartContext.tsx-72-93 (1)</summary><blockquote>\n\n`72-93`: **Missing `refreshCart` in dependency array.**\n\nThe `refreshCart` function is called inside the effect but is not listed in the dependency array. This could lead to stale closures if `refreshCart` changes.\n\n\n<details>\n<summary>Proposed fix</summary>\n\n```diff\n     return () => clearTimeout(timeoutId);\n-  }, [items, cartId, isLoaded]);\n+  }, [items, cartId, isLoaded, refreshCart]);\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/modules/resend/emails/password-reset.tsx-91-93 (1)</summary><blockquote>\n\n`91-93`: **Unsafe type cast from `unknown` to `PasswordResetEmailProps`.**\n\nCasting `unknown` directly to `PasswordResetEmailProps` without validation could cause runtime errors if the caller passes invalid data (e.g., missing `reset_url`). Consider adding runtime validation or at least providing defaults for required fields.\n\n\n<details>\n<summary>Proposed fix with basic validation</summary>\n\n```diff\n export const passwordResetEmail = (props: unknown) => {\n-  return <PasswordResetEmailComponent {...(props as PasswordResetEmailProps)} />\n+  const typedProps = props as Partial<PasswordResetEmailProps>;\n+  return (\n+    <PasswordResetEmailComponent\n+      first_name={typedProps.first_name || \"Customer\"}\n+      reset_url={typedProps.reset_url || \"#\"}\n+      expires_in={typedProps.expires_in}\n+    />\n+  );\n }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-0-customer-module-evaluation.md-94-112 (1)</summary><blockquote>\n\n`94-112`: **Doc likely stale vs this PR‚Äôs password reset implementation.**  \nThis section says password reset and its files are missing, but the PR adds those flows. Please update the evaluation to reflect the newly implemented pages/subscriber so readers aren‚Äôt misled.  \n\n\n\nAlso applies to: 266-272\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/account.forgot-password.tsx-21-35 (1)</summary><blockquote>\n\n`21-35`: **Add try/catch for error resilience.**\n\nIf `requestPasswordReset` throws an unexpected error (network failure, etc.), the component will crash. Consider wrapping in try/catch for defensive error handling.\n\n\n<details>\n<summary>Proposed fix</summary>\n\n```diff\n     const handleSubmit = async (e: React.FormEvent) => {\n         e.preventDefault();\n         setError(null);\n         setIsSubmitting(true);\n \n-        const result = await requestPasswordReset(email);\n-        \n-        if (result.success) {\n-            setIsSuccess(true);\n-        } else {\n-            setError(result.error || 'Failed to request password reset. Please try again.');\n+        try {\n+            const result = await requestPasswordReset(email);\n+            \n+            if (result.success) {\n+                setIsSuccess(true);\n+            } else {\n+                setError(result.error || 'Failed to request password reset. Please try again.');\n+            }\n+        } catch (err) {\n+            setError('An unexpected error occurred. Please try again.');\n         }\n         \n         setIsSubmitting(false);\n     };\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/account.reset-password.tsx-52-67 (1)</summary><blockquote>\n\n`52-67`: **Add try-catch for robustness against unexpected exceptions.**\n\nIf `updatePassword` throws an exception (e.g., network failure), `setIsSubmitting(false)` won't execute, leaving the button in a disabled state. Wrap the async call in try-catch or use finally.\n\n\n<details>\n<summary>üõ†Ô∏è Suggested fix</summary>\n\n```diff\n     setIsSubmitting(true);\n\n-    const result = await updatePassword(password, token);\n-    \n-    if (result.success) {\n-        setIsSuccess(true);\n-        // Auto redirect after 3 seconds\n-        setTimeout(() => {\n-            navigate('/account/login');\n-        }, 3000);\n-    } else {\n-        setError(result.error || 'Failed to reset password. The link may have expired.');\n+    try {\n+        const result = await updatePassword(password, token);\n+        \n+        if (result.success) {\n+            setIsSuccess(true);\n+            // Auto redirect after 3 seconds\n+            setTimeout(() => {\n+                navigate('/account/login');\n+            }, 3000);\n+        } else {\n+            setError(result.error || 'Failed to reset password. The link may have expired.');\n+        }\n+    } catch {\n+        setError('An unexpected error occurred. Please try again.');\n+    } finally {\n+        setIsSubmitting(false);\n     }\n-    \n-    setIsSubmitting(false);\n };\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-2-edit-profile.md-277-278 (1)</summary><blockquote>\n\n`277-278`: **Heading level jumps from h2 to h4.**\n\nThe `#### Created` heading skips h3, violating markdown best practices. Change to `### Created` for proper hierarchy.\n\n\n\n<details>\n<summary>üìù Fix heading level</summary>\n\n```diff\n-#### Created\n+### Created\n 2026-01-19\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/OrderSummary.tsx-13-14 (1)</summary><blockquote>\n\n`13-14`: **Empty interface should be removed or converted to type alias.**\n\nPer static analysis, an empty interface is equivalent to `{}`. Since `OrderSummary` no longer accepts props after the refactor to `useCheckout`, remove the interface entirely.\n\n\n\n<details>\n<summary>üßπ Remove empty interface</summary>\n\n```diff\n-import { useCheckout } from './checkout/CheckoutProvider';\n-\n-export interface OrderSummaryProps {\n-}\n+import { useCheckout } from './checkout/CheckoutProvider';\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/CustomerContext.tsx-135-151 (1)</summary><blockquote>\n\n`135-151`: **Check cart-transfer responses before logging success.**  \n`monitoredFetch` won‚Äôt throw on non‚Äë2xx responses, so the current code can log success even when the transfer failed. Please gate the success log on `response.ok` (or throw to fall into the catch).  \n\n<details>\n<summary>üêõ Suggested fix (apply to both login and register)</summary>\n\n```diff\n-                    await monitoredFetch(`/api/carts/${cartId}/transfer`, {\n+                    const transferResponse = await monitoredFetch(`/api/carts/${cartId}/transfer`, {\n                         method: 'POST',\n                         headers: {\n                             'Content-Type': 'application/json',\n                             'Authorization': `Bearer ${newToken}`,\n                         },\n                         label: 'cart-transfer-on-login',\n                     });\n-                    console.log('[CustomerContext] Cart transferred successfully:', cartId);\n+                    if (!transferResponse.ok) {\n+                        throw new Error(`Cart transfer failed (${transferResponse.status})`);\n+                    }\n+                    console.log('[CustomerContext] Cart transferred successfully:', cartId);\n```\n\n```diff\n-                    await monitoredFetch(`/api/carts/${cartId}/transfer`, {\n+                    const transferResponse = await monitoredFetch(`/api/carts/${cartId}/transfer`, {\n                         method: 'POST',\n                         headers: {\n                             'Content-Type': 'application/json',\n                             'Authorization': `Bearer ${regToken}`,\n                         },\n                         label: 'cart-transfer-on-register',\n                     });\n-                    console.log('[CustomerContext] Cart transferred successfully:', cartId);\n+                    if (!transferResponse.ok) {\n+                        throw new Error(`Cart transfer failed (${transferResponse.status})`);\n+                    }\n+                    console.log('[CustomerContext] Cart transferred successfully:', cartId);\n```\n</details>\n\n\nAlso applies to: 207-222\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üßπ Nitpick comments (33)</summary><blockquote>\n\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-1-password-reset.md (1)</summary><blockquote>\n\n`216-227`: **Add language specifiers to fenced code blocks.**\n\nThe JSON payload examples are missing language specifiers, which affects syntax highlighting and linting compliance.\n\n\n<details>\n<summary>üìù Suggested fix</summary>\n\n```diff\n **Request Reset Payload:**\n-```\n+```json\n {\n   \"identifier\": \"customer@example.com\"\n }\n ```\n\n **Update Password Payload:**\n-```\n+```json\n {\n   \"password\": \"newPassword123\"\n }\n ```\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (1)</summary><blockquote>\n\n`19-19`: **Consider replacing `networkidle` with more specific waits.**\n\n`waitForLoadState(\"networkidle\")` can be flaky in CI environments, especially with long-polling or analytics requests. Consider waiting for specific UI elements that indicate readiness instead.\n\n\n<details>\n<summary>üí° Alternative approach</summary>\n\n```diff\n     await page.goto(`/products/${product.handle}`);\n-    await page.waitForLoadState(\"networkidle\");\n+    await expect(page.getByRole(\"button\", { name: /hang it up|add to cart/i }).first()).toBeVisible();\n```\n\n```diff\n     await expect(page).toHaveURL(/\\/checkout/);\n-    await page.waitForLoadState(\"networkidle\");\n+    // Wait for checkout form to be ready\n+    await expect(page.frameLocator('iframe[title*=\"Secure email input\"]').first().locator('input[name=\"email\"]')).toBeVisible({ timeout: 10000 });\n```\n</details>\n\n\nAlso applies to: 33-33\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/story-2026-01-19-checkout-remediation.md (1)</summary><blockquote>\n\n`284-284`: **Use markdown link syntax for consistency.**\n\nThe bare URL should be wrapped in markdown link syntax to maintain consistency with the other reference links in the document.\n\n\n<details>\n<summary>üìù Suggested fix</summary>\n\n```diff\n-- Medusa Checkout Docs: https://docs.medusajs.com/resources/storefront-development/checkout/\n+- Medusa Checkout Docs: <https://docs.medusajs.com/resources/storefront-development/checkout/>\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary><blockquote>\n\n`9-16`: **CSRF protection properly guards the proxy action handler.**\n\nThe implementation correctly:\n- Validates CSRF token before forwarding requests to the backend\n- Returns 403 with appropriate error for invalid tokens\n- Only applies to `action` (POST/PUT/DELETE), not `loader` (GET)\n\nMinor note: `params` is destructured but unused in the action function.\n\n\n\n<details>\n<summary>üßπ Remove unused params</summary>\n\n```diff\n-export async function action({ request, params, context }: ActionFunctionArgs) {\n+export async function action({ request, context }: ActionFunctionArgs) {\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (1)</summary><blockquote>\n\n`36-38`: **Use timing-safe comparison for CSRF token validation.**\n\nCSRF token validation via simple string comparison (`===`) is vulnerable to timing attacks, which allow attackers to statistically recover token bytes through response-time measurements. While the practical risk is lower for CSRF tokens than authentication tokens due to defense-in-depth measures (SameSite cookies, Origin checks), OWASP explicitly recommends constant-time comparison as a security best practice.\n\nThe suggested fix using `crypto.timingSafeEqual` is the correct approach. Ensure the length check occurs before the comparison to avoid timing leaks:\n\n<details>\n<summary>üîí Suggested implementation using crypto.timingSafeEqual</summary>\n\n```diff\n+import { timingSafeEqual } from \"crypto\";\n+\n+function safeCompare(a: string, b: string): boolean {\n+    if (a.length !== b.length) return false;\n+    const bufA = Buffer.from(a);\n+    const bufB = Buffer.from(b);\n+    return timingSafeEqual(bufA, bufB);\n+}\n+\n export async function validateCSRFToken(request: Request, secret?: string) {\n     const cookie = getCSRFCookie(secret);\n     const cookieHeader = request.headers.get(\"Cookie\");\n     const session = (await cookie.parse(cookieHeader)) || {};\n     const storedToken = session.token;\n     \n     const headerToken = request.headers.get(\"X-CSRF-Token\");\n     \n     if (!storedToken || !headerToken) return false;\n\n-    return storedToken === headerToken;\n+    return safeCompare(storedToken, headerToken);\n }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary><blockquote>\n\n`38-40`: **Move import to top of file and remove placeholder comment.**\n\nThe import statement should be placed with other imports at the top of the file (after line 5). The `// ...` comment on line 40 appears to be an artifact that should be removed.\n\n\n<details>\n<summary>Suggested organization</summary>\n\n```diff\n import { type ActionFunctionArgs, type LoaderFunctionArgs, data } from \"react-router\";\n import { MedusaCartService, type Cart } from \"../services/medusa-cart\";\n import type { CartItem } from \"../types/product\";\n import { isMedusaId } from \"../types/product\";\n import { createLogger, getTraceIdFromRequest } from \"../lib/logger\";\n+import { validateCSRFToken } from \"../utils/csrf.server\";\n```\n\nThen remove lines 38-40.\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.complete.ts (1)</summary><blockquote>\n\n`8-10`: **Move import to top and remove placeholder comment.**\n\nSame as other routes‚Äîplace the import at the top with other imports and remove the `// ...` artifact.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (1)</summary><blockquote>\n\n`14-16`: **Move import to top and remove placeholder.**\n\nConsistent with other routes, move the `validateCSRFToken` import to the top of the file with other imports.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.test.ts (2)</summary><blockquote>\n\n`20-24`: **LGTM on CSRF mock setup.**\n\nThe mock pattern correctly intercepts CSRF validation. Consider adding a test case that verifies 403 is returned when CSRF validation fails (`mockValidateCSRFToken.mockResolvedValue(false)`).\n\n---\n\n`54-56`: **Remove artifact comment and empty lines.**\n\nThe `// Removed duplicate mock` comment and extra blank lines appear to be leftover from refactoring.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.shipping-methods.ts (1)</summary><blockquote>\n\n`18-20`: **Move import to top and remove placeholder comment.**\n\nSame cleanup as other routes‚Äîconsolidate imports at the top of the file.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.ts (1)</summary><blockquote>\n\n`31-33`: **Move imports to the top of the file.**\n\nThe import statement for `validateCSRFToken` is placed after type definitions (lines 6-29), which violates standard JavaScript/TypeScript import ordering conventions. The orphaned `// ...` comment on line 33 appears to be a leftover artifact.\n\n\n<details>\n<summary>Proposed fix</summary>\n\nMove the import to the top of the file with other imports:\n\n```diff\n import { type ActionFunctionArgs, data } from \"react-router\";\n import { createLogger, getTraceIdFromRequest } from \"../lib/logger\";\n import { medusaFetch } from \"../lib/medusa-fetch\";\n+import { validateCSRFToken } from \"../utils/csrf.server\";\n\n // Helper types for Medusa responses\n type MedusaPaymentCollection = {\n```\n\nThen remove lines 31-33:\n\n```diff\n-import { validateCSRFToken } from \"../utils/csrf.server\";\n-\n-// ...\n-\n export async function action({ request, context }: ActionFunctionArgs) {\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/MedusaCartContext.tsx (1)</summary><blockquote>\n\n`112-123`: **`setCart` missing from useMemo dependencies.**\n\nWhile `setCart` is a stable React state setter and won't cause issues, React's exhaustive-deps rule expects it to be included. Consider adding it to the dependency array for consistency.\n\n\n<details>\n<summary>Proposed fix</summary>\n\n```diff\n   const value = useMemo(\n     () => ({\n       cartId,\n       cart,\n       isLoading,\n       error,\n       setCart,\n       setCartId,\n       refreshCart,\n     }),\n-    [cartId, cart, isLoading, error, setCartId, refreshCart]\n+    [cartId, cart, isLoading, error, setCart, setCartId, refreshCart]\n   );\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/modules/resend/emails/password-reset.tsx (1)</summary><blockquote>\n\n`1-1`: **Avoid blanket `@ts-nocheck`; use targeted suppressions.**\n\nUsing `@ts-nocheck` disables all type checking for the file, potentially hiding real issues. If the mismatch is specifically with `@react-email/components` types, consider using targeted `@ts-expect-error` comments only where needed, or updating the library/types.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/hooks/useShippingRates.ts (1)</summary><blockquote>\n\n`165-239`: **Consider guarding `items` to improve clarity and reduce payload size.**\n\nThe backend handler explicitly checks `if (items && items.length > 0)` before processing, so sending an empty items array is non-destructive. However, the frontend always includes `items` in the update payload even when empty. While this works safely, conditionally adding `items` mirrors the backend's defensive pattern and avoids unnecessary data transmission.\n\nThe suggested refactor remains valid for consistency:\n\n<details>\n<summary>‚ôªÔ∏è Conditional items inclusion</summary>\n\n```diff\n-        const updatePayload: Record<string, unknown> = {\n-          items,\n-          promo_codes: appliedPromoCodes\n-            ?.filter(code => !code.isAutomatic)\n-            .map(code => code.code) || []\n-        };\n+        const updatePayload: Record<string, unknown> = {\n+          promo_codes: appliedPromoCodes\n+            ?.filter(code => !code.isAutomatic)\n+            .map(code => code.code) || []\n+        };\n+        if (items.length > 0) {\n+          updatePayload.items = items;\n+        }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/hooks/useCheckoutState.test.ts (1)</summary><blockquote>\n\n`6-81`: **Consider covering the remaining action creators.**  \n`setShippingPersisted`, `setPaymentCollectionId`, and `reset` aren‚Äôt exercised yet; adding tests would complete the hook‚Äôs public API coverage.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (2)</summary><blockquote>\n\n`9-15`: **CSRF validation added ‚Äî good security hardening, but review error response consistency and fallback secret.**\n\nTwo concerns:\n\n1. **Error key inconsistency**: Line 14 returns `{ error: \"Invalid CSRF token\" }` but Line 6 returns `{ message: \"Method not allowed\" }`. Consider using a consistent key across all error responses.\n\n2. **Hardcoded fallback secret**: The `\"dev-secret-key\"` fallback could mask missing configuration in production. Consider failing explicitly when `JWT_SECRET` is not set in non-development environments, or at minimum, log a warning.\n\n\n\n<details>\n<summary>Suggested consistency fix</summary>\n\n```diff\n     if (!isValidCSRF) {\n-        return data({ error: \"Invalid CSRF token\" }, { status: 403 });\n+        return data({ message: \"Invalid CSRF token\" }, { status: 403 });\n     }\n```\n</details>\n\n---\n\n`10-10`: **Use typed environment access instead of `as any`.**\n\nOther routes in this PR (e.g., `api.carts.ts`) properly type the env object with `JWT_SECRET?: string`. This file uses `as any`, which bypasses type safety.\n\n\n\n<details>\n<summary>Align with typed pattern</summary>\n\n```diff\n-    const env = context.cloudflare.env as any;\n+    const env = context.cloudflare.env as {\n+        JWT_SECRET?: string;\n+        STRIPE_SECRET_KEY?: string;\n+    };\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (1)</summary><blockquote>\n\n`8-10`: **CSRF import placement is unconventional.**\n\nConsider moving this import to the top with other imports for consistency. The inline comment is helpful but the import grouping could be cleaner.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.ts (1)</summary><blockquote>\n\n`12-13`: **Import placement after interface definition is unusual.**\n\nConsider moving the import to the top with other imports (after line 4) for conventional code organization.\n\n\n\n```diff\n import { type ActionFunctionArgs, data } from \"react-router\";\n import { medusaFetch } from \"../lib/medusa-fetch\";\n import { MedusaCartService } from \"../services/medusa-cart\";\n import { createLogger, getTraceIdFromRequest } from \"../lib/logger\";\n+import { validateCSRFToken } from \"../utils/csrf.server\";\n\n interface CreateCartRequest {\n   region_id?: string;\n   currency?: string;\n   country_code?: string;\n }\n-\n-import { validateCSRFToken } from \"../utils/csrf.server\";\n```\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/checkout/ShippingSection.tsx (1)</summary><blockquote>\n\n`34-69`: **Consider adding accessibility attributes to the radio group.**\n\nThe shipping options render as radio inputs but lack a `role=\"radiogroup\"` and `aria-labelledby` on the container. Screen readers benefit from explicit grouping.\n\n\n\n<details>\n<summary>Accessibility enhancement</summary>\n\n```diff\n       ) : shippingOptions.length > 0 ? (\n-        <div className=\"space-y-3\">\n+        <div className=\"space-y-3\" role=\"radiogroup\" aria-labelledby=\"shipping-heading\">\n           {shippingOptions.map((option) => (\n```\n\nAnd update the heading:\n```diff\n-      <h2 className=\"text-lg font-medium mb-4\">Delivery Method</h2>\n+      <h2 id=\"shipping-heading\" className=\"text-lg font-medium mb-4\">Delivery Method</h2>\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/order-canceled.ts (1)</summary><blockquote>\n\n`18-52`: **Consider using a structured logger instead of console.log/console.error.**\n\nThe handler uses `console.log` (lines 18, 24, 38) and `console.error` (lines 27, 40, 52) throughout. For production observability and consistent log formatting, consider using a structured logger like the one used in the storefront routes (`createLogger`).\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (1)</summary><blockquote>\n\n`32-41`: **Consider sanitizing error details in response.**\n\nExposing `error.message` directly in the response could leak internal implementation details. Consider providing a generic message or sanitizing the error.\n\n\n<details>\n<summary>Proposed fix</summary>\n\n```diff\n   } catch (error: any) {\n     console.error(`Error transferring cart ${cartId}:`, error);\n     \n     // Check if it's already transferred or other client error\n     const status = error.status || 500;\n+    const isClientError = status >= 400 && status < 500;\n     return data({ \n       error: \"Failed to transfer cart\", \n-      details: error.message \n+      details: isClientError ? error.message : undefined\n     }, { status });\n   }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/order-placed.ts (1)</summary><blockquote>\n\n`303-323`: **Consider consolidating duplicate order queries.**\n\nThe order is queried twice via `query.graph` (lines 58-88 and 306-323). While the second query fetches slightly different fields, most overlap. Consider fetching all needed fields in a single query and reusing the result to reduce database load.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/checkout/CheckoutContent.tsx (1)</summary><blockquote>\n\n`74-98`: **Consider memoizing `handleAddressChange` with `useCallback`.**\n\nUnlike `handleShippingSelect` (line 70-72), this handler is not memoized. If passed to child components, it could cause unnecessary re-renders since it creates a new function reference on every render.\n\n\n<details>\n<summary>‚ôªÔ∏è Suggested refactor</summary>\n\n```diff\n-  const handleAddressChange = async (event: StripeAddressElementChangeEvent) => {\n+  const handleAddressChange = useCallback(async (event: StripeAddressElementChangeEvent) => {\n     if (!event.complete || !event.value.address) return;\n     const addr = event.value;\n     // ... rest of implementation\n     });\n-  };\n+  }, [actions]);\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.complete.test.ts (2)</summary><blockquote>\n\n`10-18`: **Remove unused MedusaCartService mock.**\n\nThe `api.carts.$id.complete` route uses `monitoredFetch` directly to call Medusa's API, not `MedusaCartService`. The mock functions `mockGetCart`, `mockCompleteCart`, and `mockUpdateCart` are defined but never used in these tests.\n\n\n<details>\n<summary>‚ôªÔ∏è Suggested cleanup</summary>\n\n```diff\n-// Mock functions\n-const mockGetCart = vi.fn();\n-const mockCompleteCart = vi.fn();\n-const mockUpdateCart = vi.fn();\n-\n-// Mock MedusaCartService\n-vi.mock(\"../services/medusa-cart\", () => ({\n-  MedusaCartService: class {\n-    constructor() {}\n-    getCart = mockGetCart;\n-    completeCart = mockCompleteCart;\n-    updateCart = mockUpdateCart;\n-  },\n-}));\n-\n // Mock monitoredFetch\n const mockMonitoredFetchFn = vi.fn();\n```\n</details>\n\n---\n\n`49-57`: **Add explicit status code assertion for consistency.**\n\nThe 405 test checks the error message but not the HTTP status code. Other tests (e.g., line 67) explicitly assert the status. Consider adding `expect((response as any).init.status).toBe(405);` for completeness.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/checkout.tsx (1)</summary><blockquote>\n\n`42-43`: **Silent catch block may hide sessionStorage errors.**\n\nThe empty catch block silently swallows any sessionStorage errors. While sessionStorage failures are typically non-critical, consider logging in development mode for debugging purposes.\n\n\n\n<details>\n<summary>üîß Optional: Add dev-mode logging</summary>\n\n```diff\n     try {\n       sessionStorage.removeItem('verifiedOrder');\n       sessionStorage.removeItem('lastOrder');\n-    } catch (e) {}\n+    } catch (e) {\n+      if (import.meta.env.DEV) {\n+        console.warn('Failed to clear session storage:', e);\n+      }\n+    }\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (1)</summary><blockquote>\n\n`83-84`: **Redundant placeholder comment.**\n\nThe comment `// ... (existing imports)` serves no purpose and appears to be leftover from refactoring.\n\n\n\n<details>\n<summary>üßπ Remove placeholder comment</summary>\n\n```diff\n import { data } from \"react-router\";\n-\n-// ... (existing imports)\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-2-edit-profile.md (1)</summary><blockquote>\n\n`216-239`: **ASCII diagrams: Consider adding language specifier for consistency.**\n\nThe fenced code blocks for UI mockups don't have a language specified. Per static analysis hints, consider adding `text` or `plaintext` for consistency, though these are ASCII diagrams rather than code.\n\n\n\n<details>\n<summary>üìù Add language specifier</summary>\n\n```diff\n ### Read Mode\n-```\n+```text\n ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n```\n\nApply similarly to the Edit Mode block.\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/checkout/CheckoutProvider.tsx (2)</summary><blockquote>\n\n`23-23`: **Unused variable `isDevelopment`.**\n\nThe constant `isDevelopment` is declared but never used in the file.\n\n\n\n<details>\n<summary>üßπ Remove unused variable</summary>\n\n```diff\n-const isDevelopment = import.meta.env.MODE === 'development';\n```\n</details>\n\n---\n\n`56-64`: **Consider adding proper types instead of `any`.**\n\nSeveral interface properties use `any` type which reduces type safety:\n- `initialPaymentSession: any`\n- `appliedPromoCodes: any[]`\n- `automaticPromotions: any[]`\n- `logger: any`\n\nConsider defining or importing proper types for these when time permits.\n\n\n\n\nAlso applies to: 79-79\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/OrderSummary.tsx (1)</summary><blockquote>\n\n`70-70`: **Redundant conditional check.**\n\nThe check `onApplyPromoCode && onRemovePromoCode` is now always truthy since these functions are always provided by the `useCheckout` hook. This conditional can be removed.\n\n\n\n<details>\n<summary>üßπ Remove redundant conditional</summary>\n\n```diff\n            {/* Promo Code Input */}\n-           {onApplyPromoCode && onRemovePromoCode && (\n-               <PromoCodeInput\n+           <PromoCodeInput\n                    cartId={cartId}\n                    appliedCodes={appliedPromoCodes}\n                    onApply={onApplyPromoCode}\n                    onRemove={onRemovePromoCode}\n                    isLoading={isPromoLoading}\n                    error={promoError}\n                    successMessage={promoSuccessMessage}\n                />\n-           )}\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<!-- This is an auto-generated comment by CodeRabbit for review status -->","submittedAt":"2026-01-20T01:46:48Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"4bfb4f78fecf742dc5a3f5fc39e00202daa9908b"}},{"id":"PRR_kwDOQZPgfs7bWWeH","author":{"login":"github-advanced-security"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T02:22:34Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"52e414ab3ad6edffdbf22caf14030d958977e418"}},{"id":"PRR_kwDOQZPgfs7bWY_a","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"**Actionable comments posted: 9**\n\n> [!CAUTION]\n> Some comments are outside the diff and can‚Äôt be posted inline due to platform limitations.\n> \n> \n> \n> <details>\n> <summary>‚ö†Ô∏è Outside diff range comments (3)</summary><blockquote>\n> \n> <details>\n> <summary>apps/storefront/app/components/CheckoutForm.test.tsx (1)</summary><blockquote>\n> \n> `174-180`: **localStorage mock is missing `removeItem` method.**\n> \n> If `CheckoutForm` or its dependencies call `localStorage.removeItem()`, the test will throw a `TypeError`. Consider adding the missing method for completeness.\n> \n> \n> \n> <details>\n> <summary>Proposed fix</summary>\n> \n> ```diff\n>          const localStorageMock = {\n>              getItem: vi.fn(),\n>              setItem: vi.fn(),\n>              clear: vi.fn(),\n> +            removeItem: vi.fn(),\n>          };\n> ```\n> \n> </details>\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (1)</summary><blockquote>\n> \n> `66-72`: **Guard provider_id type to avoid runtime 500s.**  \n> If the client sends a non-string `provider_id`, `startsWith` throws. Reject early with 400 instead of crashing.  \n> \n> <details>\n> <summary>üõ†Ô∏è Suggested fix</summary>\n> \n> ```diff\n> -  const provider_id = body.provider_id || \"pp_stripe\";\n> +  const provider_id = body.provider_id ?? \"pp_stripe\";\n> +  if (typeof provider_id !== \"string\") {\n> +    logger.error(\"Invalid provider ID format\", undefined, { provider_id });\n> +    return data({ error: \"Invalid provider ID format\", traceId }, { status: 400 });\n> +  }\n> ```\n> </details>\n> \n> </blockquote></details>\n> <details>\n> <summary>apps/backend/integration-tests/unit/email-queue.unit.spec.ts (1)</summary><blockquote>\n> \n> `55-85`: **Fix test expectations for `jobName`/`jobId` after enqueueEmail changes.**\n> \n> The implementation now uses a template-based `jobName` and a UUID-suffixed `jobId`. The test still asserts entityId-based values, so it will fail. Update to use the `Templates` enum and match the new `jobName/jobId` shape.\n> \n> \n> <details>\n> <summary>üß™ Proposed test fix</summary>\n> \n> ```diff\n> -import { getEmailQueue, enqueueEmail, initEmailQueue } from \"../../src/lib/email-queue\"\n> +import { getEmailQueue, enqueueEmail, initEmailQueue } from \"../../src/lib/email-queue\"\n> +import { Templates } from \"../../src/modules/resend/service\"\n> ...\n> -      template: \"order-placed\" as const,\n> +      template: Templates.ORDER_PLACED,\n> ...\n> -    expect(queue.add).toHaveBeenCalledWith(\n> -      \"email-ord_123\",\n> +    expect(queue.add).toHaveBeenCalledWith(\n> +      \"email-order-placed\",\n>        payload,\n>        expect.objectContaining({\n> -        jobId: \"email-ord_123\",\n> +        jobId: expect.stringMatching(/^email-order-placed-ord_123-/),\n>          attempts: 3,\n>          backoff: {\n>            type: \"exponential\",\n>            delay: 1000,\n>          },\n>        })\n>      )\n> ```\n> </details>\n> \n> </blockquote></details>\n> \n> </blockquote></details>\n\n<details>\n<summary>ü§ñ Fix all issues with AI agents</summary>\n\n```\nIn `@apps/backend/src/subscribers/customer-password-reset.ts`:\n- Around line 46-57: The handler currently logs success regardless of\nenqueueEmail outcome; modify the code that calls enqueueEmail (the call passing\nentityId: customer.id, template: Templates.PASSWORD_RESET, recipient:\ncustomer.email) to check its return value, and if it returns null/false treat it\nas a failure: log an error (use logger.error) including the masked email via\nmaskEmail(customer.email) and return early instead of logging the success\nmessage; only call logger.info(`[PASSWORD_RESET] Reset email queued for\n${maskEmail(customer.email)}`) when enqueueEmail indicates success.\n\nIn `@apps/e2e/tests/full-checkout.happy.spec.ts`:\n- Around line 87-92: The current block silently skips filling card details if\npaymentIframe.locator('input[name=\"number\"]') (cardNumber) isn't visible within\n5s, which can mask failures; change this to explicitly assert visibility or\nhandle alternatives: either replace the conditional with an explicit visibility\ncheck/assert on cardNumber (so the test fails fast) or add a clear else branch\nthat handles saved-payment flows (with a comment stating saved payments are\nexpected) or throws a descriptive error; update the logic around paymentIframe\nand cardNumber to make the expected UI state explicit rather than silently\nproceeding.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.shipping-methods.ts:\n- Around line 31-40: Guard access to context.cloudflare by using optional\nchaining before casting to CloudflareEnv: replace direct dereference of\ncontext.cloudflare.env with (context.cloudflare?.env) and handle the case where\nit's undefined by returning the same server configuration error (traceId) and\nstatus 500. Ensure subsequent calls that use jwtSecret (resolveCSRFSecret and\nvalidateCSRFToken) only run when jwtSecret is present, keeping existing\ndata(...) error returns intact.\n\nIn `@apps/storefront/app/routes/api.checkout-session.ts`:\n- Line 27: The code uses a forced type assertion for STRIPE_SECRET_KEY without\nvalidating it; update the initialization of the STRIPE_SECRET_KEY constant to\nfirst check that env.STRIPE_SECRET_KEY is present and non-empty (e.g., if\n(!env.STRIPE_SECRET_KEY) throw or return a clear error/HTTP 500 with a\ndescriptive message), then assign it to STRIPE_SECRET_KEY (remove the\nunconditional \"as string\" assertion); ensure any downstream use (e.g., creating\nthe Stripe client or calling createCheckoutSession) only runs after this\nvalidation so the API call won't fail with an unclear authorization error.\n\nIn `@apps/storefront/app/utils/csrf.server.ts`:\n- Around line 19-26: The getCSRFCookie function reads process.env.NODE_ENV\ndirectly which crashes in Cloudflare Workers; change the secure flag to guard\naccess to process like resolveCSRFSecret does (e.g., check typeof process !==\n\"undefined\" && process.env && process.env.NODE_ENV === \"production\"), and fall\nback to using import.meta.env.PROD if present, so update the secure calculation\ninside getCSRFCookie to use that guarded expression.\n\nIn `@docs/sprint/sprint-artifacts/cust-0-customer-module-evaluation.md`:\n- Line 16: Convert bold-only headings like \"**Overall Score: 5.5/10**\" into\nproper markdown headings (e.g., prefixed with `#/`## as appropriate) and ensure\nthere is a blank line before and after every markdown table; apply the same\nfixes to other occurrences referenced (the blocks around the content spanning\nthe ranges that include the tables and bold headings). Locate and update the\nbold-only lines (e.g., the \"Overall Score: 5.5/10\" token and similar bold\nheadings) to use heading syntax and insert a blank line above and below each\ntable delimiter so tables are separated from surrounding paragraphs.\n\nIn `@docs/sprint/sprint-artifacts/cust-1-password-reset.md`:\n- Around line 5-35: The document still shows \"Status: Backlog\" and multiple \"NOT\nimplemented\" rows under \"Current State\" even though the PR implements the reset\npages, subscriber, and template; update the top-level Status to \"Completed\" (or\n\"Done\") and change the table entries for \"Forgot Password Page\", \"Reset Password\nPage\", \"Reset Email Template\", and \"Password Reset Subscriber\" to \"Implemented\"\n(or add a clear \"(implemented in PR #...)\" note), or alternatively add a\none-line banner under the Overview stating \"Snapshot (pre-implementation)\" if\nyou intend to keep the doc as a pre-PR snapshot; make these edits in the same\ndocument sections titled \"Status\" and \"Current State\" to remove the\ninconsistency.\n\nIn `@docs/sprint/sprint-artifacts/cust-2-edit-profile.md`:\n- Around line 109-126: The catch block in updateProfile uses error.message but\ncaught errors are unknown in TypeScript; change the catch handling in the\nupdateProfile function to safely extract a message (e.g. use a type guard like\n\"if (error instanceof Error) return error.message\" or fallback to String(error)\n/ 'Unknown error') and return that string in the returned object so TypeScript\nno longer accesses error.message on an unknown type.\n\nIn `@docs/sprint/sprint-artifacts/story-2026-01-19-cart-migration-medusa-docs.md`:\n- Around line 1-6: Change the document header Status from \"Draft\" to \"Completed\"\n(or \"Implemented\") to reflect the finished work; update the Date if needed and\nadd a one-line note in the doc summarizing implemented items (e.g.,\nMedusaCartContext, cart transfer endpoint, CSRF protection for cart APIs) so\nreaders can immediately see the deliverables have been merged.\n```\n\n</details>\n\n<details>\n<summary>‚ôªÔ∏è Duplicate comments (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary><blockquote>\n\n`52-61`: **CSRF validation addresses previous security concern.**\n\nThe use of `resolveCSRFSecret` properly handles the production vs development scenarios, eliminating the hardcoded fallback issue flagged in past reviews.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (1)</summary><blockquote>\n\n`15-24`: **CSRF validation addresses previous security concern.**\n\nThe implementation now uses `resolveCSRFSecret` which properly returns `null` in production when `JWT_SECRET` is missing, triggering a 500 response instead of using a predictable fallback.\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üßπ Nitpick comments (11)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/components/CheckoutForm.test.tsx (1)</summary><blockquote>\n\n`62-106`: **Consider test isolation for shared mock state.**\n\nThe `mockCheckoutState` object is shared across all tests and isn't reset in `beforeEach`. If any test were to mutate this object (e.g., `mockCheckoutState.status = 'error'`), it could leak into subsequent tests. `vi.clearAllMocks()` only resets call history, not object state.\n\nCurrent tests appear safe (no mutations observed), but this is worth noting for future test additions.\n\n\n\n<details>\n<summary>Optional: Reset mock state in beforeEach</summary>\n\n```diff\n beforeEach(async () => {\n     vi.clearAllMocks();\n+    // Reset mock state to avoid test pollution\n+    Object.assign(mockCheckoutState, {\n+        shippingOptions: [\n+            { id: 'standard', displayName: 'Standard', amount: 5, deliveryEstimate: '3-5 days' },\n+            { id: 'express', displayName: 'Express', amount: 15, deliveryEstimate: '1-2 days' }\n+        ],\n+        selectedShippingOption: { id: 'standard', displayName: 'Standard', amount: 5 },\n+        email: 'test@example.com',\n+        status: 'ready',\n+        address: null,\n+        billingAddress: null,\n+        error: null,\n+    });\n     mockStripe.confirmPayment.mockResolvedValue({ error: null });\n```\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-2-edit-profile.md (1)</summary><blockquote>\n\n`223-246`: **Optional: Address markdown linting issues.**\n\nSeveral fenced code blocks are missing language specifiers, and there's a heading level inconsistency:\n\n- Lines 223-246: ASCII art UI mockups should specify ` ```text `\n- Line 253: Fenced code block in UI design should specify language\n- Line 279: Reference code block should specify language  \n- Line 284: The `#### Created` heading uses an inconsistent level (h4); consider `##` or remove the heading entirely since the date is already in the metadata (line 8)\n\n\n\n<details>\n<summary>üìù Proposed markdown improvements</summary>\n\nFor the UI design sections (lines 223-231 and 235-245):\n```diff\n-```\n+```text\n ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n ‚îÇ Profile                [Edit]       ‚îÇ\n ...\n```\n\nFor the verification section code block (line 253):\n```diff\n-```\n+```plaintext\n ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n ...\n```\n\nFor line 284, either remove the heading or adjust the level:\n```diff\n-#### Created\n-2026-01-19\n+## Created\n+2026-01-19\n```\n\n</details>\n\n\n\nAlso applies to: 253-253, 279-279, 284-284\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (3)</summary><blockquote>\n\n`19-19`: **Avoid `networkidle` for more reliable tests.**\n\n`waitForLoadState(\"networkidle\")` is fragile and can cause flaky tests. Playwright's auto-waiting on element interactions is usually sufficient. If you need to wait, prefer waiting for a specific element that indicates the page is ready.\n\n\n\n<details>\n<summary>Suggested approach</summary>\n\n```diff\n-    await page.waitForLoadState(\"networkidle\");\n+    // Playwright auto-waits for elements; if explicit wait needed, wait for a specific element\n+    await page.getByRole(\"button\", { name: /hang it up|add to cart/i }).first().waitFor();\n```\n</details>\n\n---\n\n`65-67`: **Consider a more specific selector for shipping method.**\n\n`page.getByRole(\"radio\").first()` is generic and could match unintended radios if the page structure changes. A more specific selector would improve test stability.\n\n\n\n<details>\n<summary>Suggested approach</summary>\n\n```diff\n-    const shippingRadio = page.getByRole(\"radio\").first();\n+    // Use a more specific selector within the shipping section\n+    const shippingRadio = page.locator('[data-testid=\"shipping-section\"]').getByRole(\"radio\").first();\n+    // Or match by label if shipping methods have predictable names:\n+    // const shippingRadio = page.getByRole(\"radio\", { name: /standard|express/i });\n```\n</details>\n\n---\n\n`72-78`: **Fragile XPath-based locator for order total.**\n\nThe `xpath=following-sibling::*` selector is brittle and harder to maintain. Consider using a `data-testid` attribute or a more semantic selector if available in the OrderSummary component.\n\n\n\n<details>\n<summary>Suggested approach</summary>\n\n```diff\n-    const finalTotal = page.locator('text=Total').locator('xpath=following-sibling::*').first();\n-    // We expect a total greater than 0\n-    await expect(async () => {\n-        const text = await finalTotal.innerText();\n-        const value = parseFloat(text.replace(/[^0-9.]/g, ''));\n-        expect(value).toBeGreaterThan(0);\n-    }).toPass();\n+    // Prefer a test-id or semantic selector if available\n+    const finalTotal = page.getByTestId('order-total');\n+    await expect(async () => {\n+        const text = await finalTotal.innerText();\n+        const value = parseFloat(text.replace(/[^0-9.]/g, ''));\n+        expect(value).toBeGreaterThan(0);\n+    }).toPass();\n```\n\nThis requires adding `data-testid=\"order-total\"` to the OrderSummary component.\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (1)</summary><blockquote>\n\n`38-46`: **Consider validating item price format before parsing.**\n\n`parseFloat(item.price.replace('$', ''))` will produce `NaN` if `item.price` is malformed (e.g., missing, empty, or non-numeric). This could result in invalid Stripe line items.\n\n\n<details>\n<summary>üí° Suggested defensive parsing</summary>\n\n```diff\n  items.forEach((item, index) => {\n      body.append(`line_items[${index}][price_data][currency]`, currency || \"usd\");\n      body.append(`line_items[${index}][price_data][product_data][name]`, item.title);\n      const imageUrl = item.image.startsWith('http') ? item.image : `${origin}${item.image}`;\n      body.append(`line_items[${index}][price_data][product_data][images][0]`, imageUrl);\n-     const unitAmount = Math.round(parseFloat(item.price.replace('$', '')) * 100);\n+     const priceValue = parseFloat((item.price || '0').replace(/[^0-9.]/g, ''));\n+     const unitAmount = Math.round((isNaN(priceValue) ? 0 : priceValue) * 100);\n      body.append(`line_items[${index}][price_data][unit_amount]`, unitAmount.toString());\n      body.append(`line_items[${index}][quantity]`, item.quantity.toString());\n  });\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (1)</summary><blockquote>\n\n`265-290`: **Dead code: `regionOptions` is fetched but never used.**\n\nThe `regionOptions` array is populated (lines 265-280) for \"enrichment\" purposes per the comments, but it's never referenced in the `formattedOptions` mapping (lines 282-290). This results in an unnecessary API call.\n\nEither remove the unused fetch or implement the intended enrichment logic.\n\n\n<details>\n<summary>‚ôªÔ∏è Option 1: Remove unused code</summary>\n\n```diff\n-    let regionOptions: any[] = [];\n-    if (regionId) {\n-        try {\n-            const optionsResponse = await medusaFetch(`/store/shipping-options?region_id=${regionId}`, {\n-                method: \"GET\",\n-                label: \"medusa-shipping-options-enrich\",\n-                context,\n-            });\n-            if (optionsResponse.ok) {\n-                const data = await optionsResponse.json() as { shipping_options: any[] };\n-                regionOptions = data.shipping_options;\n-            }\n-        } catch (e) {\n-            logger.warn(\"Failed to fetch region options for enrichment\", { error: e });\n-        }\n-    }\n-\n     const formattedOptions = shippingOptions.map(opt => {\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (1)</summary><blockquote>\n\n`83-84`: **Remove artifact comment.**\n\nThe comment `// ... (existing imports)` appears to be a leftover from code editing and doesn't serve any purpose.\n\n\n<details>\n<summary>üßπ Remove artifact</summary>\n\n```diff\n import { createCSRFToken, resolveCSRFSecret } from \"./utils/csrf.server\";\n import { data } from \"react-router\";\n\n-// ... (existing imports)\n-\n export async function loader({ request, context }: Route.LoaderArgs) {\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary><blockquote>\n\n`39-41`: **Remove artifact comment between imports.**\n\nThe `// ...` comment is a leftover from code editing.\n\n\n<details>\n<summary>üßπ Remove artifact</summary>\n\n```diff\n import { resolveCSRFSecret, validateCSRFToken } from \"../utils/csrf.server\";\n\n-// ...\n-\n /**\n  * PATCH /api/carts/:id\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.ts (1)</summary><blockquote>\n\n`13-14`: **Consider grouping imports at the top of the file.**\n\nThe CSRF imports are placed after the `CreateCartRequest` interface. While functional, grouping all imports together at the top improves readability and follows common conventions.\n\n\n<details>\n<summary>üßπ Move imports to top</summary>\n\n```diff\n import { type ActionFunctionArgs, data } from \"react-router\";\n import { medusaFetch } from \"../lib/medusa-fetch\";\n import { MedusaCartService } from \"../services/medusa-cart\";\n import { createLogger, getTraceIdFromRequest } from \"../lib/logger\";\n import type { CloudflareEnv } from \"../utils/monitored-fetch\";\n+import { resolveCSRFSecret, validateCSRFToken } from \"../utils/csrf.server\";\n\n interface CreateCartRequest {\n   region_id?: string;\n   currency?: string;\n   country_code?: string;\n }\n\n-import { resolveCSRFSecret, validateCSRFToken } from \"../utils/csrf.server\";\n-\n /**\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (1)</summary><blockquote>\n\n`54-63`: **Consider using structured logging instead of console.error.**\n\nOther routes in this PR use the `createLogger` utility for structured logging. For consistency, consider using the same pattern here.\n\n\n<details>\n<summary>üí° Use structured logger</summary>\n\n```diff\n+import { createLogger, getTraceIdFromRequest } from \"../lib/logger\";\n\n // ... in the action function:\n+  const traceId = getTraceIdFromRequest(request);\n+  const logger = createLogger({ traceId, context: \"api.carts.$id.transfer\" });\n\n   } catch (error: any) {\n-    console.error(`Error transferring cart ${cartId}:`, error);\n+    logger.error(`Error transferring cart ${cartId}`, error);\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üìú Review details</summary>\n\n**Configuration used**: Organization UI\n\n**Review profile**: CHILL\n\n**Plan**: Pro\n\n<details>\n<summary>üì• Commits</summary>\n\nReviewing files that changed from the base of the PR and between bd2cba4562bc8513d0efddcba1fb0e3d2345df7b and 52e414ab3ad6edffdbf22caf14030d958977e418.\n\n</details>\n\n<details>\n<summary>üìí Files selected for processing (30)</summary>\n\n* `apps/backend/integration-tests/unit/email-queue.unit.spec.ts`\n* `apps/backend/integration-tests/unit/email-worker.unit.spec.ts`\n* `apps/backend/src/lib/admin-notifications.ts`\n* `apps/backend/src/lib/email-queue.ts`\n* `apps/backend/src/subscribers/customer-password-reset.ts`\n* `apps/e2e/tests/full-checkout.happy.spec.ts`\n* `apps/storefront/app/components/CheckoutForm.test.tsx`\n* `apps/storefront/app/components/checkout/PaymentSection.tsx`\n* `apps/storefront/app/context/CartContext.tsx`\n* `apps/storefront/app/context/MedusaCartContext.tsx`\n* `apps/storefront/app/root.tsx`\n* `apps/storefront/app/routes/api.carts.$id.complete.ts`\n* `apps/storefront/app/routes/api.carts.$id.shipping-methods.ts`\n* `apps/storefront/app/routes/api.carts.$id.transfer.ts`\n* `apps/storefront/app/routes/api.carts.$id.ts`\n* `apps/storefront/app/routes/api.carts.ts`\n* `apps/storefront/app/routes/api.checkout-session.ts`\n* `apps/storefront/app/routes/api.payment-collections.$id.sessions.ts`\n* `apps/storefront/app/routes/api.payment-collections.ts`\n* `apps/storefront/app/routes/api.shipping-rates.ts`\n* `apps/storefront/app/routes/api/$.tsx`\n* `apps/storefront/app/routes/order_.status.$id.tsx`\n* `apps/storefront/app/utils/csrf.server.ts`\n* `apps/storefront/app/utils/monitored-fetch.ts`\n* `docs/sprint/sprint-artifacts/cust-0-customer-module-evaluation.md`\n* `docs/sprint/sprint-artifacts/cust-1-password-reset.md`\n* `docs/sprint/sprint-artifacts/cust-2-edit-profile.md`\n* `docs/sprint/sprint-artifacts/cust-3-address-management.md`\n* `docs/sprint/sprint-artifacts/story-2026-01-19-cart-migration-medusa-docs.md`\n* `docs/sprint/sprint-artifacts/story-2026-01-19-checkout-remediation.md`\n\n</details>\n\n<details>\n<summary>üöß Files skipped from review as they are similar to previous changes (6)</summary>\n\n* apps/storefront/app/components/checkout/PaymentSection.tsx\n* apps/storefront/app/routes/order_.status.$id.tsx\n* apps/storefront/app/routes/api.carts.$id.complete.ts\n* apps/backend/src/lib/admin-notifications.ts\n* apps/storefront/app/routes/api.payment-collections.ts\n* docs/sprint/sprint-artifacts/story-2026-01-19-checkout-remediation.md\n\n</details>\n\n<details>\n<summary>üß∞ Additional context used</summary>\n\n<details>\n<summary>üß¨ Code graph analysis (12)</summary>\n\n<details>\n<summary>apps/storefront/app/context/MedusaCartContext.tsx (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/types/promotion.ts (1)</summary>\n\n* `CartWithPromotions` (91-118)\n\n</details>\n<details>\n<summary>apps/storefront/app/context/LocaleContext.tsx (1)</summary>\n\n* `useLocale` (227-233)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `monitoredFetch` (261-407)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10221-10221)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10221-10221)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary><blockquote>\n\n<details>\n<summary>apps/backend/src/utils/logger.ts (1)</summary>\n\n* `logger` (120-155)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary>\n\n* `action` (9-24)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/customer-password-reset.ts (5)</summary><blockquote>\n\n<details>\n<summary>apps/backend/src/utils/logger.ts (1)</summary>\n\n* `logger` (120-155)\n\n</details>\n<details>\n<summary>apps/backend/src/lib/env.ts (1)</summary>\n\n* `getEnv` (98-103)\n\n</details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary>\n\n* `enqueueEmail` (54-77)\n\n</details>\n<details>\n<summary>apps/backend/src/utils/email-masking.ts (1)</summary>\n\n* `maskEmail` (13-53)\n\n</details>\n<details>\n<summary>apps/backend/src/subscribers/order-placed.ts (1)</summary>\n\n* `config` (415-417)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (5)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary>\n\n* `action` (47-216)\n\n</details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary>\n\n* `action` (9-24)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n<details>\n<summary>apps/storefront/app/lib/medusa-fetch.ts (1)</summary>\n\n* `medusaFetch` (84-114)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/root.tsx (1)</summary>\n\n* `loader` (85-133)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/CartContext.tsx (5)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/types/promotion.ts (1)</summary>\n\n* `CartWithPromotions` (91-118)\n\n</details>\n<details>\n<summary>apps/storefront/app/context/MedusaCartContext.tsx (1)</summary>\n\n* `useMedusaCart` (133-139)\n\n</details>\n<details>\n<summary>apps/storefront/app/context/LocaleContext.tsx (1)</summary>\n\n* `useLocale` (227-233)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `monitoredFetch` (261-407)\n\n</details>\n<details>\n<summary>apps/storefront/app/lib/price.ts (2)</summary>\n\n* `fromCents` (121-123)\n* `calculateTotal` (138-143)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `createCSRFToken` (28-46)\n\n</details>\n<details>\n<summary>apps/storefront/app/context/MedusaCartContext.tsx (1)</summary>\n\n* `MedusaCartProvider` (18-131)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10221-10221)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10221-10221)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-29)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n\n</details><details>\n<summary>ü™õ GitHub Check: CodeQL</summary>\n\n<details>\n<summary>apps/backend/src/lib/email-queue.ts</summary>\n\n[failure] 69-69: Clear-text logging of sensitive information\nThis logs sensitive data returned by [an access to PASSWORD_RESET](1) as clear text.\n\n</details>\n\n</details>\n<details>\n<summary>ü™õ LanguageTool</summary>\n\n<details>\n<summary>docs/sprint/sprint-artifacts/story-2026-01-19-cart-migration-medusa-docs.md</summary>\n\n[style] ~71-~71: Three successive sentences begin with the same word. Consider rewording the sentence or use a thesaurus to find a synonym.\nContext: ...is transferred when the user logs in. - Cart context exposes Medusa cart object and ...\n\n(ENGLISH_WORD_REPEAT_BEGINNING_RULE)\n\n</details>\n\n</details>\n<details>\n<summary>ü™õ markdownlint-cli2 (0.18.1)</summary>\n\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-2-edit-profile.md</summary>\n\n253-253: Fenced code blocks should have a language specified\n\n(MD040, fenced-code-language)\n\n---\n\n279-279: Fenced code blocks should have a language specified\n\n(MD040, fenced-code-language)\n\n</details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-0-customer-module-evaluation.md</summary>\n\n16-16: Emphasis used instead of a heading\n\n(MD036, no-emphasis-as-heading)\n\n---\n\n276-276: Tables should be surrounded by blank lines\n\n(MD058, blanks-around-tables)\n\n---\n\n285-285: Tables should be surrounded by blank lines\n\n(MD058, blanks-around-tables)\n\n---\n\n293-293: Tables should be surrounded by blank lines\n\n(MD058, blanks-around-tables)\n\n---\n\n334-334: Emphasis used instead of a heading\n\n(MD036, no-emphasis-as-heading)\n\n</details>\n<details>\n<summary>docs/sprint/sprint-artifacts/cust-1-password-reset.md</summary>\n\n253-253: Fenced code blocks should have a language specified\n\n(MD040, fenced-code-language)\n\n</details>\n\n</details>\n\n</details>\n\n<details>\n<summary>‚è∞ Context from checks skipped due to timeout of 90000ms. You can increase the timeout in your CodeRabbit configuration to a maximum of 15 minutes (900000ms). (3)</summary>\n\n* GitHub Check: guardrails/scan\n* GitHub Check: Codacy Static Code Analysis\n* GitHub Check: Workers Builds: gracestowelstorefront-staging\n\n</details>\n\n<details>\n<summary>üîá Additional comments (38)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/components/CheckoutForm.test.tsx (2)</summary><blockquote>\n\n`211-220`: **Good migration to context-based action.**\n\nThe test correctly validates that selecting a shipping option triggers the context action `selectShippingOption` with the expected option object, aligning with the checkout architecture refactor.\n\n---\n\n`281-328`: **Thorough express checkout test coverage.**\n\nThe tests comprehensively cover the express checkout flow including success, payment error, and submit error scenarios. The assertion at line 327 correctly validates that `confirmPayment` is not called when `elements.submit` fails.\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (4)</summary><blockquote>\n\n`21-33`: **Previous review concerns addressed.**\n\nThe test now correctly uses Playwright's standard `.click()` method for both the \"Add to Cart\" button and the checkout link, which properly leverages Playwright's actionability checks.\n\nThe same `networkidle` consideration from line 19 applies to line 33 as well.\n\n---\n\n`35-60`: **Well-structured Stripe iframe interactions.**\n\nThe `frameLocator` approach is correct for Stripe Elements. Using `Date.now()` for email uniqueness ensures test isolation. The partial title matching (`title*=`) is appropriate for Stripe's dynamically-titled iframes.\n\n---\n\n`94-97`: **LGTM!**\n\nCorrectly waits for the payment button to be enabled before clicking, with a reasonable timeout for payment processing readiness.\n\n---\n\n`99-109`: **Good success page verification.**\n\nComprehensive assertions covering the URL redirect, success heading, confirmation message, and order number display. The 30-second timeout appropriately accounts for Stripe's redirect latency.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (4)</summary><blockquote>\n\n`4-16`: **Imports look good.**  \nNice addition of CloudflareEnv typing and CSRF helpers.\n\n---\n\n`28-37`: **CSRF gate + config error handling is solid.**  \nReturning 500 for missing secret and 403 for invalid tokens is clear and safe.\n\n---\n\n`44-48`: **Collection ID validation is a good guardrail.**  \nThe prefix + length check should prevent malformed collection IDs early.\n\n---\n\n`50-64`: **Robust JSON parsing and error handling.**  \nGraceful handling of invalid JSON and unreadable bodies is well done.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (2)</summary><blockquote>\n\n`20-27`: **CloudflareEnv extension looks good.**\n\nAdding `JWT_SECRET` and `NODE_ENV` aligns the type with new CSRF flows.\n\n---\n\n`271-287`: **Same-origin CSRF header injection is solid.**\n\nURL parsing + protocol checks prevent token leakage to protocol‚Äërelative or cross‚Äëorigin URLs.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary><blockquote>\n\n`9-21`: **CSRF gate is well‚Äëplaced.**\n\nEarly validation before proxying is the right control point.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/MedusaCartContext.tsx (4)</summary><blockquote>\n\n`18-50`: **Cart ID persistence is clean and SSR‚Äësafe.**\n\nSession/local storage handling and setter encapsulation look good.\n\n---\n\n`52-86`: **Refresh flow is robust.**\n\nHandles 404 cleanup, error reporting, and loading state reliably.\n\n---\n\n`92-115`: **Region sync guard is a good safety net.**\n\nThe in‚Äëflight check prevents repeat PATCH loops.\n\n---\n\n`117-130`: **Context value memoization is solid.**\n\nAvoids unnecessary re-renders while keeping the API surface clear.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/context/CartContext.tsx (5)</summary><blockquote>\n\n`2-25`: **Medusa cart surface added cleanly.**\n\nContext shape + imports align with new backend-driven cart state.\n\n---\n\n`73-94`: **Debounced backend sync is reasonable.**\n\n1s debounce with refresh on success is a good trade‚Äëoff.\n\n---\n\n`129-156`: **Fire‚Äëand‚Äëforget cart creation is safe.**\n\nGuarding with `cartCreateInFlight` keeps this non‚Äëblocking.\n\n---\n\n`199-203`: **Subtotal normalization is correct.**\n\nUsing `fromCents` avoids mixed‚Äëunit totals.\n\n---\n\n`206-218`: **Provider values updated correctly.**\n\nExposing `medusaCart` and `isLoading` keeps consumers in sync.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary><blockquote>\n\n`3-17`: **Secret resolution behavior is reasonable.**\n\nProd returns null; dev fallback is explicitly warned.\n\n---\n\n`28-63`: **Token creation/validation flow looks consistent.**\n\nShared secret resolution and header/cookie comparison are straightforward.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (1)</summary><blockquote>\n\n`10-19`: **CSRF validation implementation looks good.**\n\nThe CSRF protection follows the established pattern using `resolveCSRFSecret` and `validateCSRFToken`. This properly handles both production (returns 500 if secret missing) and development (uses fallback) scenarios.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (1)</summary><blockquote>\n\n`103-111`: **CSRF validation implementation is consistent with other routes.**\n\nThe pattern matches the established CSRF protection strategy using centralized utilities.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (2)</summary><blockquote>\n\n`93-98`: **Good: JWT_SECRET validation now throws in production.**\n\nThis addresses the previous review concern about hardcoded fallback secrets. The `resolveCSRFSecret` utility returns `null` in production when the secret is missing, and the loader correctly throws an error in that case.\n\n---\n\n`152-177`: **Provider hierarchy updated correctly with MedusaCartProvider.**\n\nThe `MedusaCartProvider` is appropriately placed to wrap `CartProvider` and `WishlistProvider`, ensuring cart context is available to all nested components.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary><blockquote>\n\n`248-253`: **Good enhancement: Loader now returns comprehensive cart data.**\n\nAdding `currency_code`, `subtotal`, `discount_total`, `shipping_total`, `tax_total`, and `total` provides clients with complete pricing information without requiring additional API calls.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.ts (1)</summary><blockquote>\n\n`26-34`: **CSRF validation implementation is consistent and correct.**\n\nFollows the established pattern using centralized CSRF utilities.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (2)</summary><blockquote>\n\n`31-35`: **Good: Authorization header is now required.**\n\nThis addresses the previous review concern about missing authentication verification. The endpoint now explicitly requires an `Authorization` header and returns 401 if absent.\n\n---\n\n`47-53`: **Potential issue: Response body consumed twice on non-OK responses.**\n\nWhen `response.ok` is false, `response.json()` is called at line 48. However, if the response status triggers an exception that's caught (e.g., network error during JSON parsing), the flow continues to the catch block. The current handling is mostly correct, but the success path at line 52 will fail if the response was already consumed in a retry scenario.\n\nThe current implementation is acceptable since line 48's `.catch(() => ({}))` handles parse failures gracefully.\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary><blockquote>\n\n`54-70`: **LGTM ‚Äî job naming + UUID-based IDs look correct.**\n\n</blockquote></details>\n<details>\n<summary>apps/backend/integration-tests/unit/email-worker.unit.spec.ts (5)</summary><blockquote>\n\n`93-157`: **Core functionality tests updated cleanly to `entityId`.**\n\n---\n\n`169-182`: **Retry logging expectations look consistent with `entityId` updates.**\n\n---\n\n`198-276`: **Alerting tests correctly switched to `entityId` semantics.**\n\n---\n\n`289-315`: **DLQ entry assertions updated consistently for `entityId`.**\n\n---\n\n`349-364`: **Invalid-email handling assertions align with `entityId` payloads.**\n\n</blockquote></details>\n\n</blockquote></details>\n\n<sub>‚úèÔ∏è Tip: You can disable this entire section by setting `review_details` to `false` in your review settings.</sub>\n\n</details>\n\n<!-- This is an auto-generated comment by CodeRabbit for review status -->","submittedAt":"2026-01-20T02:30:03Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"52e414ab3ad6edffdbf22caf14030d958977e418"}},{"id":"PRR_kwDOQZPgfs7bWmS8","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"**Actionable comments posted: 2**\n\n<details>\n<summary>ü§ñ Fix all issues with AI agents</summary>\n\n```\nIn `@apps/storefront/worker-configuration.d.ts`:\n- Around line 9-11: The JWT_SECRET and JWE_SECRET entries are incorrectly typed\nas the literal \"placeholder\" which prevents assigning real secrets; update the\nsource configuration (likely wrangler.toml) to declare these environment\nvariables as generic strings (not the literal \"placeholder\") and then re-run the\ngenerator command (wrangler types) to regenerate this file so JWT_SECRET and\nJWE_SECRET become type string (while leaving ENVIRONMENT as-is); ensure the\nsource change references the same keys used in this file (JWT_SECRET and\nJWE_SECRET) before regenerating.\n\nIn `@apps/storefront/wrangler.jsonc`:\n- Around line 73-74: The placeholders for JWT_SECRET and JWE_SECRET in\nwrangler.jsonc are too short and will fail storefrontEnvSchema validation;\neither replace each value with a 32+ character secret string (e.g., a generated\nrandom 32+ char token) so they satisfy the min-length requirement, or remove the\nJWT_SECRET and JWE_SECRET entries entirely from wrangler.jsonc if those secrets\nare not needed in CI; ensure the keys match the names used by\nstorefrontEnvSchema in env.server.ts.\n```\n\n</details>\n\n<details>\n<summary>üßπ Nitpick comments (1)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/lib/env.server.ts (1)</summary><blockquote>\n\n`72-85`: **Consider adding warnings for missing security secrets.**\n\nThe function warns about missing analytics and database configs but not about missing `JWT_SECRET` or `JWE_SECRET`. If these are recommended for secure session handling (per the schema comments), consider adding similar warnings.\n\n<details>\n<summary>üîß Optional: Add security secret warnings</summary>\n\n```diff\n   if (!validated.VITE_POSTHOG_API_KEY) {\n     logger.warn('[ENV] VITE_POSTHOG_API_KEY not set. Analytics will be disabled.');\n   }\n \n+  if (!validated.JWT_SECRET) {\n+    logger.warn('[ENV] JWT_SECRET not set. Session security features may be limited.');\n+  }\n+\n+  if (!validated.JWE_SECRET) {\n+    logger.warn('[ENV] JWE_SECRET not set. Encrypted session features may be limited.');\n+  }\n+\n   return validated;\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üìú Review details</summary>\n\n**Configuration used**: Organization UI\n\n**Review profile**: CHILL\n\n**Plan**: Pro\n\n<details>\n<summary>üì• Commits</summary>\n\nReviewing files that changed from the base of the PR and between 932c9e8ad37c0cfb3c00dda297106e740a38ca0a and fdd5b7e85a946b47c24e3a3965f41fcc06231a6a.\n\n</details>\n\n<details>\n<summary>üìí Files selected for processing (5)</summary>\n\n* `apps/backend/medusa-config.ts`\n* `apps/storefront/app/lib/env.server.ts`\n* `apps/storefront/app/utils/monitored-fetch.ts`\n* `apps/storefront/worker-configuration.d.ts`\n* `apps/storefront/wrangler.jsonc`\n\n</details>\n\n<details>\n<summary>üöß Files skipped from review as they are similar to previous changes (1)</summary>\n\n* apps/backend/medusa-config.ts\n\n</details>\n\n<details>\n<summary>üß∞ Additional context used</summary>\n\n<details>\n<summary>üß¨ Code graph analysis (1)</summary>\n\n<details>\n<summary>apps/storefront/app/lib/env.server.ts (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/lib/logger.ts (1)</summary>\n\n* `createLogger` (39-98)\n\n</details>\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10223-10223)\n\n</details>\n\n</blockquote></details>\n\n</details>\n\n</details>\n\n<details>\n<summary>‚è∞ Context from checks skipped due to timeout of 90000ms. You can increase the timeout in your CodeRabbit configuration to a maximum of 15 minutes (900000ms). (6)</summary>\n\n* GitHub Check: Storefront Tests\n* GitHub Check: E2E Tests\n* GitHub Check: Backend Unit Tests\n* GitHub Check: guardrails/scan\n* GitHub Check: Codacy Static Code Analysis\n* GitHub Check: Workers Builds: gracestowelstorefront-staging\n\n</details>\n\n<details>\n<summary>üîá Additional comments (6)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (2)</summary><blockquote>\n\n`21-33`: **Type additions look good.**\n\nNice to see the env surface explicitly modeled for the new configuration fields.\n\n---\n\n`278-294`: **CSRF header injection is now origin-safe.**\n\nURL parsing + same-origin/HTTP(S) checks are a solid safeguard.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (2)</summary><blockquote>\n\n`2-3`: **No review needed for regenerated header.**\n\n---\n\n`15-16`: **PostHog env additions look good.**\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/lib/env.server.ts (2)</summary><blockquote>\n\n`6-39`: **Well-structured environment schema with appropriate validations.**\n\nThe schema correctly enforces:\n- URL validation for backend endpoints\n- Stripe key prefix validation (sk_/pk_)\n- Minimum secret lengths for JWT/JWE tokens\n\nNote: The optional JWT_SECRET/JWE_SECRET with `min(32)` will fail validation if set to short placeholder values (e.g., in CI environments). Ensure CI secrets meet the 32-character minimum or adjust the CI configuration accordingly.\n\n---\n\n`49-66`: **Solid validation implementation with clear error reporting.**\n\nThe function correctly uses `safeParse` for safe validation, provides structured logging, and throws an actionable error with the first issue's path and message. The error formatting aligns with Zod 4's API.\n\n</blockquote></details>\n\n</blockquote></details>\n\n<sub>‚úèÔ∏è Tip: You can disable this entire section by setting `review_details` to `false` in your review settings.</sub>\n\n</details>\n\n<!-- This is an auto-generated comment by CodeRabbit for review status -->","submittedAt":"2026-01-20T03:01:26Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"fdd5b7e85a946b47c24e3a3965f41fcc06231a6a"}},{"id":"PRR_kwDOQZPgfs7bWp0S","author":{"login":"github-advanced-security"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T03:12:02Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"36b02f8ba37fc1422618771d92e0fb589b4be1c5"}},{"id":"PRR_kwDOQZPgfs7bW5SY","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"**Actionable comments posted: 5**\n\n<details>\n<summary>ü§ñ Fix all issues with AI agents</summary>\n\n```\nIn `@apps/storefront/app/components/checkout/CheckoutProvider.tsx`:\n- Around line 183-190: The variable hasFreeShipping is being destructured from\nuseAutomaticPromotions in CheckoutProvider but never used or exposed; either\nstop destructuring it or add it to the context value so consumers can access it.\nLocate the call to useAutomaticPromotions in CheckoutProvider (the variables\npromotions: automaticPromotions, hasFreeShipping) and remove hasFreeShipping\nfrom the destructuring if it‚Äôs not needed, or include hasFreeShipping in the\nobject returned by CheckoutContext/provider so downstream components can consume\nit.\n- Line 23: The variable isDevelopment is declared but never used; remove the\nunused declaration const isDevelopment = import.meta.env.MODE === 'development'\nfrom CheckoutProvider.tsx (delete the isDevelopment constant so no unused\nvariable remains) and run a quick lint to ensure no other references exist.\n- Around line 129-131: The cart creation flow in CheckoutProvider passes\nregionId (converted to \"\") into useShippingRates and the API without checking\nemptiness; add a guard like the Step 2 check so we do not send an empty\nregion_id in Step 1: before calling useShippingRates / before building the cart\ncreation payload in the CheckoutProvider (the block referencing regionId and\nuseShippingRates), return early or skip including region_id when regionId is\nfalsy (undefined or empty) so the API is not sent an empty string‚Äîmirror the\nconditional used in the Step 2 guard (lines around the Step 2 check) to locate\nand apply the same pattern.\n\nIn `@apps/storefront/app/routes/api.carts`.$id.complete.ts:\n- Around line 8-26: In the action function, guard context.cloudflare before\ndereferencing it: check whether context.cloudflare exists and only then extract\nenv (typed as CloudflareEnv) and call resolveCSRFSecret; if context.cloudflare\nis missing return the server configuration error (500) early. Update the block\nthat currently does \"const env = context.cloudflare.env as unknown as\nCloudflareEnv; const jwtSecret = resolveCSRFSecret(env.JWT_SECRET);\" to perform\na null check on context.cloudflare and use that guarded env when calling\nresolveCSRFSecret and validateCSRFToken (symbols: action, context.cloudflare,\nresolveCSRFSecret, validateCSRFToken, CloudflareEnv).\n\nIn `@apps/storefront/app/routes/api.carts`.$id.transfer.ts:\n- Around line 54-62: The catch block in the route handler currently returns raw\nerror.message to clients; instead log the full error (console.error(error) or\ninclude error.message and stack) but return a generic, non‚Äësensitive response\nfrom data(...)‚Äîe.g., replace details: error.message with either no details or a\nredacted/conditional field that only includes error.message when running in a\nnon‚Äëproduction environment (check NODE_ENV), leaving the public response as {\nerror: \"Failed to transfer cart\" } and preserving the original status logic\nusing status = error.status || 500.\n```\n\n</details>\n\n<details>\n<summary>‚ôªÔ∏è Duplicate comments (3)</summary><blockquote>\n\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (1)</summary><blockquote>\n\n`93-98`: **Avoid silently skipping card entry.**\n\nIf the card input isn‚Äôt visible, the test currently proceeds without asserting an alternative UI state, which can hide failures. Please either assert visibility or handle the alternative state explicitly.  \n  \n<details>\n<summary>‚úÖ Proposed fix</summary>\n\n```diff\n const cardNumber = paymentIframe.locator('input[name=\"number\"]');\n-if (await cardNumber.isVisible({ timeout: 5000 })) {\n-    await cardNumber.fill(\"4242424242424242\");\n-    await paymentIframe.locator('input[name=\"expiry\"]').fill(\"12/26\");\n-    await paymentIframe.locator('input[name=\"cvc\"]').fill(\"123\");\n-}\n+// Fail fast if the expected card inputs aren't present\n+await expect(cardNumber).toBeVisible({ timeout: 10000 });\n+await cardNumber.fill(\"4242424242424242\");\n+await paymentIframe.locator('input[name=\"expiry\"]').fill(\"12/26\");\n+await paymentIframe.locator('input[name=\"cvc\"]').fill(\"123\");\n```\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.shipping-methods.ts (1)</summary><blockquote>\n\n`31-40`: **Guard `context.cloudflare` to avoid runtime crashes outside Cloudflare.**  \n`context.cloudflare` can be undefined in non-Cloudflare runtimes, which would throw before returning a structured error.  \n  \n  \n\n<details>\n<summary>üõ†Ô∏è Suggested fix</summary>\n\n```diff\n-  const env = context.cloudflare.env as unknown as CloudflareEnv;\n+  const env =\n+    (context.cloudflare?.env as CloudflareEnv | undefined) ||\n+    ((context as { env?: CloudflareEnv }).env ?? {});\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (1)</summary><blockquote>\n\n`27-27`: **Validate `STRIPE_SECRET_KEY` before use.**\n\nLine 27 still assumes the key is set; missing/empty secrets will lead to confusing Stripe auth failures.\n\n\n\n\n<details>\n<summary>üîß Suggested fix</summary>\n\n```diff\n-    const STRIPE_SECRET_KEY = env.STRIPE_SECRET_KEY as string;\n+    const STRIPE_SECRET_KEY = env.STRIPE_SECRET_KEY;\n+    if (!STRIPE_SECRET_KEY) {\n+        return data({ error: \"Stripe configuration error\" }, { status: 500 });\n+    }\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üßπ Nitpick comments (11)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/hooks/useShippingRates.test.ts (2)</summary><blockquote>\n\n`65-90`: **Remove stale commented-out assertions.**\n\nLines 85-86 reference `mockMedusaClient` which doesn't exist in this test file. These appear to be leftover from a refactor. Consider removing them to avoid confusion.\n\nAdditionally, the double cast on line 67 (`as unknown as CartItem`) suggests the mock data doesn't fully match the `CartItem` interface. For better type safety, consider providing a more complete mock that satisfies the type without requiring `unknown` as an intermediary.\n\n\n\n<details>\n<summary>Suggested cleanup</summary>\n\n```diff\n     await act(async () => {\n       await result.current.fetchShippingRates(\n-        [{ id: 'item_1', price: 1000, quantity: 1 } as unknown as CartItem],\n+        [{ id: 'item_1', variant_id: 'var_1', price: 1000, quantity: 1 }] as CartItem[],\n         {\n           firstName: 'John',\n           lastName: 'Doe',\n           address: {\n             line1: '123 St',\n             city: 'NY',\n             state: 'NY',\n             postal_code: '10001',\n             country: 'US'\n           }\n         },\n         1000,\n         'test@example.com'\n       );\n     });\n\n     expect(defaultProps.setIsCalculating).toHaveBeenCalledWith(true);\n-    // expect(mockMedusaClient.carts.update).toHaveBeenCalled(); // Should be called to update email/address\n-    // expect(mockMedusaClient.shippingOptions.listCartOptions).toHaveBeenCalled();\n     expect(defaultProps.setShippingOptions).toHaveBeenCalledWith(\n         expect.arrayContaining([expect.objectContaining({ id: 'so_1' })])\n     );\n     expect(defaultProps.setIsCalculating).toHaveBeenCalledWith(false);\n```\n\n</details>\n\n---\n\n`93-103`: **Consider expanding the clearCache test to verify behavior.**\n\nThe test currently only verifies that `clearCache` exists and doesn't throw. To add meaningful coverage, you could verify caching behavior by:\n1. Calling `fetchShippingRates` with the same parameters twice\n2. Verifying `monitoredFetch` is called once (cached)\n3. Calling `clearCache`\n4. Calling `fetchShippingRates` again and verifying `monitoredFetch` is called again\n\nThis would validate that the cache is actually being used and cleared.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (1)</summary><blockquote>\n\n`15-17`: **Remove leftover placeholder comment.**\n\nLine 17 contains `// ...` which appears to be a leftover from editing. This serves no purpose and should be removed.\n\n\n\n<details>\n<summary>üßπ Suggested cleanup</summary>\n\n```diff\n import { resolveCSRFSecret, validateCSRFToken } from \"../utils/csrf.server\";\n \n-// ...\n-\n export async function action({ request, params, context }: ActionFunctionArgs) {\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/support/factories/product-factory-class.ts (1)</summary><blockquote>\n\n`101-110`: **Encode the product handle in the store check URL.**  \nIf a handle ever contains reserved characters, the request can become malformed and incorrectly trigger the fallback path. Consider encoding for safety.\n\n<details>\n<summary>‚ôªÔ∏è Proposed tweak</summary>\n\n```diff\n-            url: `/store/products?handle=${product.handle}&limit=1`,\n+            url: `/store/products?handle=${encodeURIComponent(product.handle)}&limit=1`,\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/checkout/CheckoutProvider.tsx (1)</summary><blockquote>\n\n`210-222`: **Consider memoizing the promo code mapping to reduce unnecessary shipping rate fetches.**\n\nThe `appliedPromoCodes.map(c => ({ code: c.code, isAutomatic: c.isAutomatic ?? false }))` creates new object references on every render, which could trigger the debounced effect unnecessarily even when promo codes haven't changed. Consider memoizing this mapping or comparing by promo code values rather than array reference.\n\n<details>\n<summary>üí° Suggested optimization</summary>\n\n```diff\n+  // Memoize promo code data for stable reference in dependency array\n+  const promoCodeData = useMemo(\n+    () => appliedPromoCodes.map(c => ({ code: c.code, isAutomatic: c.isAutomatic ?? false })),\n+    [appliedPromoCodes]\n+  );\n+\n   useEffect(() => {\n     if (items.length === 0) return;\n     const timer = setTimeout(() => {\n       fetchShippingRates(\n         items, \n         shippingAddress, \n         cartTotal, \n         guestEmail, \n-        appliedPromoCodes.map(c => ({ code: c.code, isAutomatic: c.isAutomatic ?? false }))\n+        promoCodeData\n       );\n     }, CHECKOUT_CONSTANTS.ADDRESS_DEBOUNCE_MS);\n     return () => clearTimeout(timer);\n-  }, [items, shippingAddress, cartTotal, fetchShippingRates, guestEmail, appliedPromoCodes]);\n+  }, [items, shippingAddress, cartTotal, fetchShippingRates, guestEmail, promoCodeData]);\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary><blockquote>\n\n`57-62`: **Confirm intended idempotency behavior for email jobs.** With `randomUUID()` every enqueue is unique, so duplicate events/retries can send multiple emails; if you still want dedupe, consider a deterministic request/event id (or update the ‚Äúidempotency key‚Äù comment to avoid confusion).\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/order-placed.ts (1)</summary><blockquote>\n\n`291-301`: **Redundant try/catch around `sendAdminNotification`.** That helper already catches/logs errors, so this block won‚Äôt execute the catch; consider either removing it or making the helper rethrow so this log can fire.  \n\n<details>\n<summary>‚ôªÔ∏è Example simplification</summary>\n\n```diff\n-  try {\n-    await sendAdminNotification(container, {\n-      type: AdminNotificationType.ORDER_PLACED,\n-      title: \"New Order Received\",\n-      description: `Order ${data.id} has been placed`,\n-      metadata: { order_id: data.id },\n-    })\n-  } catch (error: unknown) {\n-    const message = error instanceof Error ? error.message : String(error)\n-    logger.error(`[ADMIN_NOTIF][ERROR] Failed to send admin notification for order ${data.id}: ${message}`)\n-  }\n+  await sendAdminNotification(container, {\n+    type: AdminNotificationType.ORDER_PLACED,\n+    title: \"New Order Received\",\n+    description: `Order ${data.id} has been placed`,\n+    metadata: { order_id: data.id },\n+  })\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.test.ts (1)</summary><blockquote>\n\n`59-59`: **Remove the ‚ÄúRemoved duplicate mock‚Äù note.**  \nIt reads like a commit message and adds noise to the test body.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.checkout-session.ts (1)</summary><blockquote>\n\n`10-13`: **Guard Cloudflare env access in non-Cloudflare contexts.**\n\nLine 11 will throw if `context.cloudflare` is undefined (e.g., local adapter/tests). Consider the safer fallback pattern used elsewhere so the route fails gracefully instead of crashing. Please verify this route only runs with Cloudflare context; otherwise apply the guard.\n\n\n\n<details>\n<summary>‚ôªÔ∏è Suggested guard (aligns with api/$.tsx)</summary>\n\n```diff\n-    const env = context.cloudflare.env as unknown as CloudflareEnv;\n+    const env =\n+        (context.cloudflare?.env as unknown as CloudflareEnv | undefined) ||\n+        ((context as { env?: CloudflareEnv }).env ?? {});\n```\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (1)</summary><blockquote>\n\n`8-11`: **CSRF gate placement looks good; consider safer env retrieval.**\n\nCSRF validation before body parsing is a solid hardening step. Line 94 can still throw in non-Cloudflare contexts‚Äîplease verify that `context.cloudflare` is always present, or use the same fallback pattern as the proxy route.\n\n\n\n<details>\n<summary>‚ôªÔ∏è Suggested guard</summary>\n\n```diff\n-  const env = context.cloudflare.env as unknown as CloudflareEnv;\n+  const env =\n+    (context.cloudflare?.env as unknown as CloudflareEnv | undefined) ||\n+    ((context as { env?: CloudflareEnv }).env ?? {});\n```\n</details>\n\n\nAlso applies to: 94-111\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (1)</summary><blockquote>\n\n`109-115`: **Consider gating the Medusa connectivity check to non‚Äëprod.**\n\nLine 109 triggers a Medusa API call on every loader invocation; this can add latency and load in production. If it‚Äôs diagnostic, consider restricting it to dev or a feature flag.\n\n\n\n<details>\n<summary>‚ôªÔ∏è Suggested gating</summary>\n\n```diff\n-  try {\n-      const client = getMedusaClient({ cloudflare: { env } });\n-      await client.store.product.list({ limit: 1 });\n-      console.log(\"‚úÖ Medusa connection verified via loader\");\n-  } catch (err) {\n-      console.error(\"‚ùå Failed to verify Medusa connection:\", err);\n-  }\n+  if (!import.meta.env.PROD) {\n+      try {\n+          const client = getMedusaClient({ cloudflare: { env } });\n+          await client.store.product.list({ limit: 1 });\n+          console.log(\"‚úÖ Medusa connection verified via loader\");\n+      } catch (err) {\n+          console.error(\"‚ùå Failed to verify Medusa connection:\", err);\n+      }\n+  }\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üìú Review details</summary>\n\n**Configuration used**: Organization UI\n\n**Review profile**: CHILL\n\n**Plan**: Pro\n\n<details>\n<summary>üì• Commits</summary>\n\nReviewing files that changed from the base of the PR and between fdd5b7e85a946b47c24e3a3965f41fcc06231a6a and d91472228124cbbd70ef2b18fe301b1bacdc7c24.\n\n</details>\n\n<details>\n<summary>üìí Files selected for processing (29)</summary>\n\n* `apps/backend/integration-tests/unit/email-queue.unit.spec.ts`\n* `apps/backend/src/lib/email-queue.ts`\n* `apps/backend/src/subscribers/order-placed.ts`\n* `apps/e2e/support/factories/product-factory-class.ts`\n* `apps/e2e/tests/checkout.spec.ts`\n* `apps/e2e/tests/full-checkout.happy.spec.ts`\n* `apps/storefront/app/components/checkout/CheckoutProvider.tsx`\n* `apps/storefront/app/hooks/useCheckoutState.test.ts`\n* `apps/storefront/app/hooks/usePromoCode.ts`\n* `apps/storefront/app/hooks/useShippingRates.test.ts`\n* `apps/storefront/app/root.tsx`\n* `apps/storefront/app/routes/api.carts.$id.complete.test.ts`\n* `apps/storefront/app/routes/api.carts.$id.complete.ts`\n* `apps/storefront/app/routes/api.carts.$id.shipping-methods.test.ts`\n* `apps/storefront/app/routes/api.carts.$id.shipping-methods.ts`\n* `apps/storefront/app/routes/api.carts.$id.test.ts`\n* `apps/storefront/app/routes/api.carts.$id.transfer.ts`\n* `apps/storefront/app/routes/api.carts.$id.ts`\n* `apps/storefront/app/routes/api.carts.test.ts`\n* `apps/storefront/app/routes/api.carts.ts`\n* `apps/storefront/app/routes/api.checkout-session.ts`\n* `apps/storefront/app/routes/api.payment-collections.$id.sessions.test.ts`\n* `apps/storefront/app/routes/api.payment-collections.$id.sessions.ts`\n* `apps/storefront/app/routes/api.payment-collections.test.ts`\n* `apps/storefront/app/routes/api.payment-collections.ts`\n* `apps/storefront/app/routes/api.shipping-rates.test.ts`\n* `apps/storefront/app/routes/api.shipping-rates.ts`\n* `apps/storefront/app/routes/api/$.tsx`\n* `apps/storefront/app/routes/order_.status.$id.tsx`\n\n</details>\n\n<details>\n<summary>üöß Files skipped from review as they are similar to previous changes (7)</summary>\n\n* apps/storefront/app/routes/api.payment-collections.$id.sessions.test.ts\n* apps/storefront/app/hooks/useCheckoutState.test.ts\n* apps/storefront/app/routes/api.carts.ts\n* apps/storefront/app/routes/api.shipping-rates.test.ts\n* apps/backend/integration-tests/unit/email-queue.unit.spec.ts\n* apps/storefront/app/routes/api.carts.$id.shipping-methods.test.ts\n* apps/storefront/app/routes/api.carts.$id.complete.test.ts\n\n</details>\n\n<details>\n<summary>üß∞ Additional context used</summary>\n\n<details>\n<summary>üß¨ Code graph analysis (11)</summary>\n\n<details>\n<summary>apps/storefront/app/hooks/useShippingRates.test.ts (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `monitoredFetch` (268-414)\n\n</details>\n<details>\n<summary>apps/storefront/app/context/CartContext.tsx (1)</summary>\n\n* `CartItem` (11-11)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.complete.ts (5)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.shipping-methods.ts (1)</summary>\n\n* `action` (23-121)\n\n</details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary>\n\n* `action` (47-216)\n\n</details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary>\n\n* `action` (9-24)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/support/factories/product-factory-class.ts (1)</summary><blockquote>\n\n<details>\n<summary>apps/e2e/support/helpers/api-request.ts (1)</summary>\n\n* `apiRequest` (37-92)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (5)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (1)</summary>\n\n* `action` (47-216)\n\n</details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.ts (1)</summary>\n\n* `action` (19-133)\n\n</details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary>\n\n* `action` (9-24)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n<details>\n<summary>apps/storefront/app/lib/medusa-fetch.ts (1)</summary>\n\n* `medusaFetch` (84-114)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.ts (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/hooks/usePromoCode.ts (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/types/promotion.ts (2)</summary>\n\n* `AppliedPromoCode` (80-85)\n* `CartWithPromotions` (91-118)\n\n</details>\n<details>\n<summary>apps/storefront/app/lib/medusa.ts (1)</summary>\n\n* `getMedusaClient` (277-313)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/order-placed.ts (1)</summary><blockquote>\n\n<details>\n<summary>apps/backend/src/lib/admin-notifications.ts (1)</summary>\n\n* `sendAdminNotification` (43-72)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10223-10223)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.shipping-rates.ts (3)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/worker-configuration.d.ts (1)</summary>\n\n* `env` (10223-10223)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (2)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/utils/monitored-fetch.ts (1)</summary>\n\n* `CloudflareEnv` (20-36)\n\n</details>\n<details>\n<summary>apps/storefront/app/utils/csrf.server.ts (2)</summary>\n\n* `resolveCSRFSecret` (3-17)\n* `validateCSRFToken` (48-63)\n\n</details>\n\n</blockquote></details>\n\n</details>\n\n</details>\n\n<details>\n<summary>‚è∞ Context from checks skipped due to timeout of 90000ms. You can increase the timeout in your CodeRabbit configuration to a maximum of 15 minutes (900000ms). (6)</summary>\n\n* GitHub Check: Storefront Tests\n* GitHub Check: E2E Tests\n* GitHub Check: Backend Unit Tests\n* GitHub Check: guardrails/scan\n* GitHub Check: Workers Builds: gracestowelstorefront-staging\n* GitHub Check: Codacy Static Code Analysis\n\n</details>\n\n<details>\n<summary>üîá Additional comments (44)</summary><blockquote>\n\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.$id.sessions.ts (5)</summary><blockquote>\n\n`28-37`: **CSRF validation looks correct.**\n\nThe implementation properly uses `resolveCSRFSecret` which returns `null` in production when `JWT_SECRET` is missing, and the code correctly returns a 500 error in that case. This addresses the previous security concern about hardcoded fallback secrets.\n\n---\n\n`44-48`: **LGTM!**\n\nThe collectionId format validation properly checks for Medusa's expected prefixes and minimum length, preventing malformed IDs from reaching the backend.\n\n---\n\n`50-64`: **Request body handling is robust.**\n\nThe nested try-catch correctly distinguishes between body read failures (where defaults are acceptable) and JSON parse errors (which indicate a client error). The fallback to empty body when `request.text()` fails is a reasonable choice that allows the default `provider_id` to be used.\n\n---\n\n`66-72`: **LGTM!**\n\nProvider ID validation appropriately enforces Medusa's `pp_` prefix convention with a sensible minimum length.\n\n---\n\n`82-119`: **LGTM!**\n\nThe backend interaction properly uses `monitoredFetch` with appropriate headers and includes good error handling that maps status codes to user-friendly messages without exposing internal error details.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.transfer.ts (6)</summary><blockquote>\n\n`10-13`: **Clean method guard.**\n\nThe early 405 return keeps the action contract clear.\n\n---\n\n`15-24`: **CSRF enforcement aligns with other routes.**\n\nConsistent resolution and validation flow.\n\n---\n\n`26-29`: **Cart ID validation is solid.**\n\nClear 400 when the param is missing.\n\n---\n\n`31-35`: **Auth header requirement is appropriate.**\n\nGood guard before issuing the transfer.\n\n---\n\n`37-45`: **Medusa transfer call looks good.**\n\nHeaders and label wiring are consistent with the fetch wrapper.\n\n---\n\n`47-53`: **Response handling is tidy.**\n\nGraceful error parsing and success payload extraction.\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/checkout.spec.ts (2)</summary><blockquote>\n\n`11-12`: **Good defensive regex escaping.**\n\nThis helper prevents special characters in titles from breaking RegExp-based assertions.\n\n---\n\n`47-48`: **Nice consistent adoption of escaped title matching.**\n\nThese updates keep the whitespace-flexible matching while avoiding regex metacharacter pitfalls.  \n\n\n\nAlso applies to: 64-65, 86-87, 123-124, 156-157, 184-185\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/full-checkout.happy.spec.ts (4)</summary><blockquote>\n\n`21-33`: **Solid add‚Äëto‚Äëcart ‚Üí checkout transition coverage.**\n\nFlow setup and navigation look clean and readable.\n\n---\n\n`35-65`: **Clear guest identity + shipping address entry.**\n\nThe step sequencing is easy to follow and should exercise the critical path well.\n\n---\n\n`66-82`: **Good shipping selection + totals sanity check.**\n\nValidating a positive total is a helpful guard for pricing regressions.\n\n---\n\n`101-115`: **Clean submit + success assertions.**\n\nThe success-page checks provide strong end-state validation.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/order_.status.$id.tsx (3)</summary><blockquote>\n\n`2-3`: **CSRF utility imports look good.**\n\n---\n\n`34-34`: **Typed env cast is a solid safety improvement.**\n\n---\n\n`122-131`: **The CSRF validation is safe and requires no changes.**\n\nThe `validateCSRFToken` function only reads from request headers and parses the cookie header as a string‚Äîit does not call `formData()`, `json()`, or any body-consuming methods. The subsequent `request.formData()` call at line 132 will work correctly. No cloning is necessary.\n\n\n\n> Likely an incorrect or invalid review comment.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/hooks/usePromoCode.ts (6)</summary><blockquote>\n\n`1-24`: **LGTM!**\n\nThe import update to `useReducer` and the preserved public API interfaces are correct. The return type interface maintains backwards compatibility.\n\n---\n\n`49-69`: **Well-structured reducer implementation.**\n\nThe reducer correctly handles state transitions with proper mutual exclusion between error and success states. The `SET_DISCOUNT_STATE` action appropriately resets `isLoading` to ensure consistent state after async operations complete.\n\n---\n\n`75-182`: **No changes to review in this segment.**\n\nThe `extractAppliedCodesFromCart` function is unchanged and continues to correctly extract applied promo codes from cart adjustments.\n\n---\n\n`207-264`: **LGTM!**\n\nThe reducer initialization and callback implementations are correct. The `refreshDiscount` function properly handles stale request detection with `refreshRequestIdRef`, ensuring only the latest request updates state. The dispatch calls correctly map to reducer actions.\n\n---\n\n`266-330`: **LGTM!**\n\nThe `applyPromoCode` implementation correctly:\n- Validates inputs before dispatching loading state\n- References `state.appliedCodes` for duplicate detection and building the codes list\n- Verifies the code was actually applied by checking adjustments post-API call\n- Provides clear error messaging when the code is accepted by API but has no effect\n\nThe dependency array correctly includes `state.appliedCodes`.\n\n---\n\n`369-381`: **LGTM!**\n\nThe return statement correctly exposes reducer state properties, maintaining the same public API surface while using the new reducer-based internal implementation.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/components/checkout/CheckoutProvider.tsx (3)</summary><blockquote>\n\n`25-81`: **LGTM!**\n\nThe `CheckoutContextType` interface is well-organized with clear groupings for state, cart/totals, errors, hooks, payment, promo, methods, and logging. The use of `ReturnType<typeof ...>` ensures type consistency with the underlying hooks.\n\n---\n\n`85-91`: **LGTM!**\n\nThe `useCheckout` hook correctly throws an informative error when used outside of `CheckoutProvider`, following the standard React context pattern.\n\n---\n\n`224-281`: **LGTM!**\n\nThe memoized context value correctly includes all dependencies. The large dependency array is a trade-off of the centralized checkout context design. Since most callback functions (e.g., `fetchShippingRates`, `applyPromoCode`) should be stable due to `useCallback` in their source hooks, and `logger`/`sessionTraceId` are refs, the context should remain relatively stable in practice.\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/lib/email-queue.ts (1)</summary><blockquote>\n\n`2-20`: **Stronger typing and safer logging look good.** The Templates enum + generic payload shape and the sanitized log/error handling improve consistency and reduce leakage risk.  \n\n\n\nAlso applies to: 69-76\n\n</blockquote></details>\n<details>\n<summary>apps/backend/src/subscribers/order-placed.ts (1)</summary><blockquote>\n\n`10-10`: **Good alignment with enum-based templates and entityId.** Keeps payloads consistent with the queue typing and reduces string drift.  \n\n\n\nAlso applies to: 235-236\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.test.ts (2)</summary><blockquote>\n\n`21-30`: **CSRF test mock is cleanly wired.**  \nKeeps the action tests isolated from token mechanics while still exercising the CSRF gate.\n\n---\n\n`35-38`: **Default CSRF validation behavior is sensible.**  \nSetting the mock to resolve `true` in setup keeps tests deterministic.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.shipping-methods.ts (1)</summary><blockquote>\n\n`4-20`: **CSRF utility imports align with the new protection flow.**\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.test.ts (2)</summary><blockquote>\n\n`20-29`: **CSRF mock setup is clear and consistent with other tests.**\n\n---\n\n`62-65`: **Good default for CSRF validation in test setup.**\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.ts (2)</summary><blockquote>\n\n`248-253`: **Expanded cart totals in the loader response look good.**  \nThese fields improve client-side pricing visibility.\n\n---\n\n`6-6`: **Guard `context.cloudflare` before dereferencing.**\n\nLine 53 directly accesses `context.cloudflare.env` without checking if `context.cloudflare` exists. In non-Cloudflare runtimes (Node.js, Vercel, etc.), this will throw \"Cannot read property 'env' of undefined\" before reaching the error handling below.\n\nSuggested fix:\n<details>\n<summary>üõ†Ô∏è Suggested fix</summary>\n\n```diff\n-  const env = context.cloudflare.env as unknown as CloudflareEnv;\n+  const env =\n+    (context.cloudflare?.env as CloudflareEnv | undefined) ||\n+    ((context as { env?: CloudflareEnv }).env ?? {});\n```\n</details>\n\n\n\n\n> Likely an incorrect or invalid review comment.\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.carts.$id.test.ts (2)</summary><blockquote>\n\n`19-35`: **CSRF mock setup keeps PATCH tests aligned with new enforcement.**\n\n---\n\n`209-214`: **Added totals in fixtures and assertions improve coverage.**  \n\n\n\nAlso applies to: 225-229\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api/$.tsx (1)</summary><blockquote>\n\n`1-3`: **CSRF pre-proxy guard is solid.**\n\nEarly CSRF validation plus the robust env fallback make the proxy route safer without changing the proxy flow.\n\n\n\n\nAlso applies to: 9-21\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/routes/api.payment-collections.ts (1)</summary><blockquote>\n\n`4-5`: **CSRF validation before body parsing is a good hardening step.**\n\nThe early guard and clear error responses align well with the other CSRF-enabled routes.\n\n\n\n\nAlso applies to: 32-55\n\n</blockquote></details>\n<details>\n<summary>apps/storefront/app/root.tsx (2)</summary><blockquote>\n\n`95-108`: **CSRF token + cookie wiring in loader looks correct.**\n\nThe resolved secret and header return path should reliably set the CSRF cookie while exposing the token to the client.\n\n---\n\n`14-15`: **Provider composition update looks good.**\n\nWrapping `CartProvider`/`WishlistProvider` inside `MedusaCartProvider` aligns with the new cart sync flow.\n\n\n\n\nAlso applies to: 154-179\n\n</blockquote></details>\n\n</blockquote></details>\n\n<sub>‚úèÔ∏è Tip: You can disable this entire section by setting `review_details` to `false` in your review settings.</sub>\n\n</details>\n\n<!-- This is an auto-generated comment by CodeRabbit for review status -->","submittedAt":"2026-01-20T03:41:04Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"d91472228124cbbd70ef2b18fe301b1bacdc7c24"}},{"id":"PRR_kwDOQZPgfs7bXFz0","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:39Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF0B","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:40Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF0O","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:41Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF0c","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:41Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF0v","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:42Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF1C","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:43Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF1a","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:44Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXF1v","author":{"login":"codacy-production"},"authorAssociation":"NONE","body":"","submittedAt":"2026-01-20T04:00:44Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}},{"id":"PRR_kwDOQZPgfs7bXGKg","author":{"login":"coderabbitai"},"authorAssociation":"NONE","body":"**Actionable comments posted: 2**\n\n<details>\n<summary>ü§ñ Fix all issues with AI agents</summary>\n\n```\nIn `@apps/e2e/tests/checkout.spec.ts`:\n- Around line 47-50: The test's button matcher uses a loose regex that includes\n\"out of stock\", which lets the test pass for non-purchasable products; update\nthe expectation in the checkout.spec.ts to match only purchasable button labels\n(remove \"out of stock\" from page.getByRole(\"button\", { name: /hang it up|add to\ncart|out of stock/i }) and keep a stricter matcher such as /hang it up|add to\ncart/i) and then ensure the test fixture/seed or product factory used by this\nspec creates a purchasable product (adjust the product factory/fixture setup\nused by the test to set inventory/availability so the button rendered is the\nadd-to-cart state).\n- Around line 241-247: Fix the inconsistent indentation and update the button\nselector: align the indentation of the block containing page.waitForLoadState,\nthe h1 expect, and the addToCart declaration to match surrounding code, and\nchange the regex used in getByRole for the button (the addToCart variable) to\ninclude \"hang it up\" like other tests (use /hang it up|add to cart/i). Ensure\nyou still call addToCart.scrollIntoViewIfNeeded(), page.waitForTimeout(500), and\naddToCart.evaluate((el: any) => el.click()) after updating the selector.\n```\n\n</details>\n\n<details>\n<summary>üßπ Nitpick comments (2)</summary><blockquote>\n\n<details>\n<summary>apps/e2e/playwright.config.ts (1)</summary><blockquote>\n\n`83-87`: **Optional: DRY the repeated Chromium overrides.**  \nThe same `channel`/`launchOptions` pair is repeated in multiple `use` blocks. Consider extracting a shared override object to reduce churn if these settings change again.  \n\n\n<details>\n<summary>‚ôªÔ∏è Proposed refactor</summary>\n\n```diff\n const chromiumChannel = process.env.E2E_USE_SYSTEM_CHROME === \"true\" ? \"chrome\" : undefined;\n const chromiumLaunchOptions = chromiumLaunchArgs.length > 0 ? { args: chromiumLaunchArgs } : undefined;\n+const chromiumUseOverrides = { channel: chromiumChannel, launchOptions: chromiumLaunchOptions };\n\n // ...\n         {\n           name: \"chromium\",\n           use: {\n             ...devices[\"Desktop Chrome\"],\n-            channel: chromiumChannel,\n-            launchOptions: chromiumLaunchOptions,\n+            ...chromiumUseOverrides,\n           },\n         },\n\n // ...\n         {\n           name: \"chromium\",\n           use: {\n             ...devices[\"Desktop Chrome\"],\n-            channel: chromiumChannel,\n-            launchOptions: chromiumLaunchOptions,\n+            ...chromiumUseOverrides,\n           },\n         },\n\n // ...\n         {\n           name: \"Mobile Chrome\",\n           use: {\n             ...devices[\"Pixel 5\"],\n-            channel: chromiumChannel,\n-            launchOptions: chromiumLaunchOptions,\n+            ...chromiumUseOverrides,\n           },\n         },\n\n // ...\n         {\n           name: \"resilience\",\n           testDir: \"./resilience\",\n           use: {\n             ...devices[\"Desktop Chrome\"],\n-            channel: chromiumChannel,\n-            launchOptions: chromiumLaunchOptions,\n+            ...chromiumUseOverrides,\n           },\n         },\n```\n</details>\n\n\nAlso applies to: 94-98, 111-115, 125-129\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/checkout.spec.ts (1)</summary><blockquote>\n\n`59-61`: **Duplicate comment.**\n\nLine 59 and 60 both say \"Wait for product page to load\". Remove the duplicate.\n\n<details>\n<summary>Suggested fix</summary>\n\n```diff\n     // Wait for product page to load\n-    // Wait for product page to load\n     await expect(page.locator(\"h1\").filter({ hasText: product.title })).toBeVisible({ timeout: 30000 });\n```\n</details>\n\n</blockquote></details>\n\n</blockquote></details>\n\n<details>\n<summary>üìú Review details</summary>\n\n**Configuration used**: Organization UI\n\n**Review profile**: CHILL\n\n**Plan**: Pro\n\n<details>\n<summary>üì• Commits</summary>\n\nReviewing files that changed from the base of the PR and between d91472228124cbbd70ef2b18fe301b1bacdc7c24 and 683328d52d0440c24ef3230421275eeceafcb0bf.\n\n</details>\n\n<details>\n<summary>üìí Files selected for processing (4)</summary>\n\n* `CLAUDE.md`\n* `SPRINT.md`\n* `apps/e2e/playwright.config.ts`\n* `apps/e2e/tests/checkout.spec.ts`\n\n</details>\n\n<details>\n<summary>‚úÖ Files skipped from review due to trivial changes (1)</summary>\n\n* SPRINT.md\n\n</details>\n\n<details>\n<summary>‚è∞ Context from checks skipped due to timeout of 90000ms. You can increase the timeout in your CodeRabbit configuration to a maximum of 15 minutes (900000ms). (4)</summary>\n\n* GitHub Check: Validate\n* GitHub Check: Workers Builds: gracestowelstorefront-staging\n* GitHub Check: guardrails/scan\n* GitHub Check: Codacy Static Code Analysis\n\n</details>\n\n<details>\n<summary>üîá Additional comments (7)</summary><blockquote>\n\n<details>\n<summary>apps/e2e/playwright.config.ts (1)</summary><blockquote>\n\n`19-31`: **LGTM for env-driven Chromium launch settings.**  \nClean handling of CI/Mac ARM flags and avoiding empty `launchOptions` keeps Playwright config robust.\n\n</blockquote></details>\n<details>\n<summary>CLAUDE.md (3)</summary><blockquote>\n\n`116-131`: **LGTM! Clear commit workflow guidance.**\n\nThe commit rules section provides clear, actionable guidance for maintaining commit hygiene. The conventional commit format and Co-Authored-By trailer are appropriate practices for this AI-assisted development workflow.\n\n---\n\n`132-154`: **LGTM! Well-structured task tracking guidance.**\n\nThe dual tracking system is clearly explained with a logical workflow. The distinction between strategic planning (sprint-status.yaml) and tactical execution (SPRINT.md) is helpful.\n\n---\n\n`155-179`: **All listed commands exist in package.json.**\n\nVerification confirms that the 14 pnpm commands documented in this section are properly defined as scripts in the root `package.json`:\n\n**Development:** `dev:storefront`, `dev:api`, `dev:background`\n\n**Testing:** `test`, `test:storefront`, `test:backend`, `test:e2e`, `test:e2e:ui`\n\n**Building:** `build`, `lint`, `typecheck`\n\n**Deployment:** `deploy:storefront`, `deploy:api`, `deploy:background`\n\nAll commands are available and ready for developer use.\n\n</blockquote></details>\n<details>\n<summary>apps/e2e/tests/checkout.spec.ts (3)</summary><blockquote>\n\n`44-45`: **Good improvement: locator-based heading check is more stable.**\n\nThe switch from RegExp character-by-character matching to `page.locator(\"h1\").filter({ hasText: product.title })` is cleaner and less fragile.\n\n---\n\n`82-82`: **Consistent heading check pattern applied across tests.**\n\n---\n\n`118-118`: **LGTM: Heading checks are consistent.**\n\nThe locator-based heading checks are applied consistently across these test cases, improving test stability.\n\n\n\n\nAlso applies to: 150-150, 177-177, 216-216\n\n</blockquote></details>\n\n</blockquote></details>\n\n<sub>‚úèÔ∏è Tip: You can disable this entire section by setting `review_details` to `false` in your review settings.</sub>\n\n</details>\n\n<!-- This is an auto-generated comment by CodeRabbit for review status -->","submittedAt":"2026-01-20T04:01:46Z","includesCreatedEdit":false,"reactionGroups":[],"state":"COMMENTED","commit":{"oid":"683328d52d0440c24ef3230421275eeceafcb0bf"}}]}
